!function(e,t){if("function"==typeof define&&define.amd)define([],t);else if("function"==typeof define)define(t);else if("undefined"!=typeof module&&module.exports){var r=require("jszip"),n=require("fs");module.exports=t(r,n)}else e.oxml=t()}(this,function(e,t){var r,n,l;return function(e){function t(e,t){return b.call(e,t)}function o(e,t){var r,n,l,o,s,a,i,u,f,d,c,m=t&&t.split("/"),v=p.map,y=v&&v["*"]||{};if(e){for(s=(e=e.split("/")).length-1,p.nodeIdCompat&&_.test(e[s])&&(e[s]=e[s].replace(_,"")),"."===e[0].charAt(0)&&m&&(e=m.slice(0,m.length-1).concat(e)),f=0;f<e.length;f++)if("."===(c=e[f]))e.splice(f,1),f-=1;else if(".."===c){if(0===f||1===f&&".."===e[2]||".."===e[f-1])continue;f>0&&(e.splice(f-1,2),f-=2)}e=e.join("/")}if((m||y)&&v){for(f=(r=e.split("/")).length;f>0;f-=1){if(n=r.slice(0,f).join("/"),m)for(d=m.length;d>0;d-=1)if((l=v[m.slice(0,d).join("/")])&&(l=l[n])){o=l,a=f;break}if(o)break;!i&&y&&y[n]&&(i=y[n],u=f)}!o&&i&&(o=i,a=u),o&&(r.splice(0,a,o),e=r.join("/"))}return e}function s(t,r){return function(){var n=x.call(arguments,0);return"string"!=typeof n[0]&&1===n.length&&n.push(null),c.apply(e,n.concat([t,r]))}}function a(e){return function(t){y[e]=t}}function i(r){if(t(h,r)){var n=h[r];delete h[r],g[r]=!0,d.apply(e,n)}if(!t(y,r)&&!t(g,r))throw new Error("No "+r);return y[r]}function u(e){var t,r=e?e.indexOf("!"):-1;return r>-1&&(t=e.substring(0,r),e=e.substring(r+1,e.length)),[t,e]}function f(e){return e?u(e):[]}var d,c,m,v,y={},h={},p={},g={},b=Object.prototype.hasOwnProperty,x=[].slice,_=/\.js$/;m=function(e,t){var r,n=u(e),l=n[0],s=t[1];return e=n[1],l&&(r=i(l=o(l,s))),l?e=r&&r.normalize?r.normalize(e,function(e){return function(t){return o(t,e)}}(s)):o(e,s):(l=(n=u(e=o(e,s)))[0],e=n[1],l&&(r=i(l))),{f:l?l+"!"+e:e,n:e,pr:l,p:r}},v={require:function(e){return s(e)},exports:function(e){var t=y[e];return void 0!==t?t:y[e]={}},module:function(e){return{id:e,uri:"",exports:y[e],config:function(e){return function(){return p&&p.config&&p.config[e]||{}}}(e)}}},d=function(r,n,l,o){var u,d,c,p,b,x,_,C=[],S=typeof l;if(o=o||r,x=f(o),"undefined"===S||"function"===S){for(n=!n.length&&l.length?["require","exports","module"]:n,b=0;b<n.length;b+=1)if(p=m(n[b],x),"require"===(d=p.f))C[b]=v.require(r);else if("exports"===d)C[b]=v.exports(r),_=!0;else if("module"===d)u=C[b]=v.module(r);else if(t(y,d)||t(h,d)||t(g,d))C[b]=i(d);else{if(!p.p)throw new Error(r+" missing "+d);p.p.load(p.n,s(o,!0),a(d),{}),C[b]=y[d]}c=l?l.apply(y[r],C):void 0,r&&(u&&u.exports!==e&&u.exports!==y[r]?y[r]=u.exports:c===e&&_||(y[r]=c))}else r&&(y[r]=l)},r=n=c=function(t,r,n,l,o){if("string"==typeof t)return v[t]?v[t](r):i(m(t,f(r)).f);if(!t.splice){if((p=t).deps&&c(p.deps,p.callback),!r)return;r.splice?(t=r,r=n,n=null):t=e}return r=r||function(){},"function"==typeof n&&(n=l,l=o),l?d(e,t,r,n):setTimeout(function(){d(e,t,r,n)},4),c},c.config=function(e){return c(e)},r._defined=y,(l=function(e,r,n){if("string"!=typeof e)throw new Error("See almond README: incorrect module build, no module name");r.splice||(n=r,r=[]),t(y,e)||t(h,e)||(h[e]=[e,r,n])}).amd={jQuery:!0}}(),l("build/almond",function(){}),l("fileHandler",[],function(){"use strict";return{createFile:function(e,t){var r=e,n={_zip:r};return n.addFile=function(e,t,n){var l;n&&(l=r.folder(n)),(l||r).file(t,e)},n.saveFile=function(e,n){return"undefined"!=typeof window?r.generateAsync({type:"blob"}).then(function(t){try{if(window.saveAs)return saveAs(t,e);var r=window.URL.createObjectURL(t),l=document.createElement("a");if(l.setAttribute("href",r),l.setAttribute("download",e),l.style.display="none",document.body.appendChild(l),l.click(),document.body.removeChild(l),n)n();else if("undefined"!=typeof Promise)return new Promise(function(e,t){e()})}catch(e){if(n)n("Err: Not able to create file object.");else if("undefined"!=typeof Promise)return new Promise(function(e,t){t("Err: Not able to create file object.")})}}):n?(r.generateNodeStream({type:"nodebuffer",streamFiles:!0}).pipe(t.createWriteStream(e)),void n()):new Promise(function(n,l){r.generateNodeStream({type:"nodebuffer",streamFiles:!0}).pipe(t.createWriteStream(e)),n()})},n}}}),l("oxml_rels",[],function(){"use strict";var e=function(e,t,r,n){n.relations.push({Id:e,Type:t,Target:r})},t=function(e){var t,r='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">';for(t=0;t<e.relations.length;t++){var n=e.relations[t];r+='<Relationship Id="'+n.Id+'" Type="'+n.Type+'" Target="'+n.Target+'"/>'}return r+="</Relationships>"},r=function(e,r){var n=t(r);e.addFile(n,r.fileName,r.folderName)},n=function(e){e.relations=null,delete e.relations,e.addRelation=null,delete e.addRelation,e.generateContent=null,delete e.generateContent,e.attach=null,delete e.attach};return{createRelation:function(l,o){var s={relations:[],fileName:l,folderName:o};return s.addRelation=function(t,r,n){e(t,r,n,s)},s.generateContent=function(){return t(s)},s.attach=function(e){return r(e,s)},s.destroy=function(){n(s)},s}}}),l("oxml_content_types",[],function(){"use strict";var e=function(e){var t,r='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types">';for(t=0;t<e.contentTypes.length;t++){var n=e.contentTypes[t];r+="<"+n.name+' ContentType="'+n.contentType+'" ',n.Extension&&(r+='Extension="'+n.Extension+'" '),n.PartName&&(r+='PartName="'+n.PartName+'" '),r+="/>\n"}return r+="</Types>"},t=function(t,r){var n=e(r);t.addFile(n,"[Content_Types].xml")},r=function(e,t,r,n){var l={name:e,contentType:t};for(var o in r)l[o]=r[o];n.contentTypes.push(l)},n=function(e){e.addContentType=null,delete e.addContentType,e.generateContent=null,delete e.generateContent,e.attach=null,delete e.attach,e.contentTypes=null,delete e.contentTypes};return{createContentType:function(){var l={contentTypes:[]};return l.addContentType=function(e,t,n){r(e,t,n,l)},l.generateContent=function(){return e(l)},l.attach=function(e){return t(e,l)},l.destroy=function(){n(l)},l}}}),l("oxml_table",[],function(){var e=function(e){var t='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><table totalsRowShown="0" ref="'+e.fromCell+":"+e.toCell+'" displayName="'+e.displayName+'" name="'+e.displayName+'" id="'+e.rid+'" xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main">';if(e.filters){t+='<autoFilter ref="'+e.fromCell+":"+e.toCell+'">';for(var r=0;r<e.filters.length;r++){if(t+='<filterColumn colId="'+e.filters[r].column+'">',"default"===e.filters[r].values[0].type){t+="<filters>";for(var n=0;n<e.filters[r].values.length;n++)t+='<filter val="'+e.filters[r].values[n].value+'"/>';t+="</filters>"}else if("custom"===e.filters[r].values[0].type){t+='<customFilters and="'+(e.filters[r].values[0].and?"1":"0")+'">';for(var n=0;n<e.filters[r].values.length;n++)t+='<customFilter operator="'+e.filters[r].values[n].operator+'" val="'+e.filters[r].values[n].value+'"/>';t+="</customFilters>"}t+="</filterColumn>"}t+="</autoFilter>"}e.sort&&(t+='<sortState caseSensitive="'+(e.sort.caseSensitive?"1":"0")+'" ref="'+e.sort.dataRange+'">',t+="<sortCondition"+("ascending"===e.sort.direction?"":' descending="1"')+' ref="'+e.sort.range+'"/>',t+="</sortState>"),t+='<tableColumns count="'+e.columns.length+'">';for(var r=0;r<e.columns.length;r++)t+='<tableColumn name="'+e.columns[r]+'" id="'+(r+1)+'"/>';var l="";return e.tableStyle&&(l='<tableStyleInfo name="'+e.tableStyle.name+'" showColumnStripes="'+(e.tableStyle.showColumnStripes?"1":"0")+'" showRowStripes="'+(e.tableStyle.showRowStripes?"1":"0")+'" showLastColumn="'+(e.tableStyle.showLastColumn?"1":"0")+'" showFirstColumn="'+(e.tableStyle.showFirstColumn?"1":"0")+'"/>'),t+="</tableColumns>"+l+"</table>"},t=function(t,r){var n=e(t);r.addFile(n,"table"+t.rid+".xml","workbook/tables")},r=function(e,t,r){if(t.filters||(t.filters=[]),"object"==typeof e.filters&&e.filters.length)for(var n=0;n<e.filters.length;n++){var l;if(e.filters[n].value)l=[],l.push({value:e.filters[n].value,type:e.filters[n].type||"default",operator:e.filters[n].operator||null,and:!1!==e.filters[n].and}),o(r,e.filters[n].column-1,[e.filters[n].value],t.fromCell,t.toCell,e.filters[n].operator);else if(e.filters[n].values&&"object"==typeof e.filters[n].values&&e.filters[n].values.length){l=[];for(var s=0;s<e.filters[n].values.length;s++)l.push({value:e.filters[n].values[s],type:e.filters[n].type||"default",operator:e.filters[n].operator||null,and:!1!==e.filters[n].and});o(r,e.filters[n].column-1,e.filters[n].values,t.fromCell,t.toCell,e.filters[n].operator)}t.filters.push({column:e.filters[n].column-1,values:l})}},n=function(e,t){var r={},n=t.fromColumn-1,l=t.toColumn-1,o=t.fromRow,s=t.toRow;"number"==typeof e.sort?(n=String.fromCharCode(e.sort+n+64),r.direction="ascending",r.caseSensitive=!0):"object"==typeof e.sort&&!e.sort.length&&e.sort.column&&(n=String.fromCharCode(e.sort.column+n+64),r.direction=e.sort.direction||"ascending",r.caseSensitive=void 0===e.sort.caseSensitive||e.sort.caseSensitive),r.range=n+(o+1)+":"+n+s,r.dataRange=String.fromCharCode(t.fromColumn+64)+(o+1)+":"+String.fromCharCode(l+65)+s,t.sort=r},l=function(e,t,l){e&&(e.filters&&r(e,t,l),e.sort&&n(e,t))},o=function(e,t,r,n,l,o){var s=parseInt(n.match(/\d+/)[0],10),a=parseInt(l.match(/\d+/)[0],10);t+=n.match(/\D+/)[0].toUpperCase().charCodeAt()-65;for(var i=s;i<a;i++){var u=!1;if(e.values[i])if(!o||"greaterThan"!==o&&"greaterThanOrEqual"!==o&&"lessThan"!==o&&"lessThanOrEqual"!==o)u="notEqual"===o?r.indexOf(e.values[i][t].value)>-1:!(r.indexOf(e.values[i][t].value)>-1);else{u=!0;for(var f=0;f<r.length;f++){switch(o){case"greaterThan":e.values[i][t].value>r[f]&&(u=!1);break;case"greaterThanOrEqual":case"lessThan":case"lessThanOrEqual":e.values[i][t].value>=r[f]&&(u=!1)}if(!u)break}}u&&(e.values[i].hidden=!0)}},s=function(e,t,r,n){r._workBook.createStyles().addTableStyle(e,t),n.tableStyle={name:t,showColumnStripes:!(!e.evenColumn&&!e.oddColumn),showRowStripes:!(!e.evenRow&&!e.oddRow),showLastColumn:!!e.lastColumn,showFirstColumn:!!e.firstColumn}},a=function(e,t,r){return{_table:e,set:function(n){return l(n,e,t),a(e,t,r)},style:function(n,l){return l||(l="customTableStyle"+r),s(n,l,t,e),a(e,t,r)}}};return{addTable:function(r,n,o,s,i,u,f){var d=parseInt(n.match(/\d+/)[0],10),c=parseInt(o.match(/\d+/)[0],10),m=n.match(/\D+/)[0].toUpperCase().charCodeAt()-64,v=o.match(/\D+/)[0].toUpperCase().charCodeAt()-64,y={rid:i,displayName:r,columns:s,fromCell:n,toCell:o,fromRow:d,toRow:c,fromColumn:m,toColumn:v};return l(u,y,f),{_table:y,rid:i,generateContent:function(){e(y)},attach:function(e){t(y,e)},tableOptions:function(){return a(y,f,i)}}}}}),l("oxml_sheet",["oxml_table","oxml_rels"],function(e,t){"use strict";var r=function(e,t,r,n){if(!e)return"";var l=e.styleIndex?' s="'+e.styleIndex+'" ':"";if("numeric"===e.type)return'<c r="'+t+'" '+l+"><v>"+e.value+"</v></c>";if("sharedString"===e.type)return'<c r="'+t+'" t="s" '+l+"><v>"+e.value+"</v></c>";if("sharedFormula"===e.type){var o="";return e.value&&"function"==typeof e.value?o="<v>"+e.value(r+1,n+1)+"</v>":void 0!==e.value&&null!==e.value&&(o="<v>"+e.value+"</v>"),e.formula?'<c  r="'+t+'" '+l+'><f t="shared" ref="'+e.range+'" si="'+e.si+'">'+e.formula+"</f>"+o+"</c>":'<c  r="'+t+'" '+l+'><f t="shared" si="'+e.si+'"></f>'+o+"</c>"}if("string"===e.type)return'<c r="'+t+'" t="inlineStr" '+l+"><is><t>"+e.value+"</t></is></c>";if("formula"===e.type){var o="";return e.value&&"function"==typeof e.value?o="<v>"+e.value(r+1,n+1)+"</v>":void 0!==e.value&&null!==e.value&&(o="<v>"+e.value+"</v>"),'<c r="'+t+'" '+l+"><f>"+e.formula+"</f>"+o+"</c>"}},n=function(e,t){var n=0,l="";if(e.values&&e.values.length)for(n=0;n<e.values.length;n++)if(e.values[n]&&e.values[n].length>0){var o=e.values[n].hidden?' hidden="1" ':"";l+='<row r="'+(n+1)+'"'+o+">\n";var s=0;for(s=0;s<e.values[n].length;s++){var a=String.fromCharCode(65+s),i=e.values[n][s],u=a+(n+1),f=r(i,u,n,s);l+=f}l+="</row>"}var d="";if(e.tables&&e.tables.length){d+='<tableParts count="'+e.tables.length+'">';for(var c=0;c<e.tables.length;c++)d+='<tablePart r:id="rId'+e.tables[c].rid+'"/>',t&&e.tables[c].attach(t);d+="</tableParts>"}return'<worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"><sheetData>'+l+"</sheetData>"+d+"</worksheet>"},l=function(e,t){var r=n(e,t);t.addFile(r,"sheet"+e.sheetId+".xml","workbook/sheets"),e._rels&&e._rels.attach(t)},o=function(e,t){if(void 0===e||null===e)return null;if("object"==typeof e){if(!(void 0!==e.value&&null!==e.value||e.formula&&"formula"===e.type))return null;if(e.type)return"sharedString"===e.type?"number"==typeof e.value?{type:e.type,value:e.value}:(e.value=t._workBook.createSharedString(e.value,t._workBook),{type:e.type,value:e.value}):"formula"===e.type?{type:e.type,formula:e.formula,value:e.value}:"numeric"===e.type||"string"===e.type?{type:e.type,value:e.value}:null;e=e.value}return"number"==typeof e?{type:"numeric",value:e}:"string"==typeof e?{type:"string",value:e}:"boolean"==typeof e?{type:"string",value:e+""}:null},s=function(e,t,r,n,l,s){var a,i;if(l){l.cellIndices=s;i=t._workBook.createStyles().addStyles(l)}for(a=0;a<e.length;a++)if(void 0!==e[a]||null!==e[a]){var u=a+r-1;if(t.values[u]||(t.values[u]=[]),"object"==typeof e[a]&&e[a].length>=0){var f;for(f=0;f<e[a].length;f++){var d=o(e[a][f],t);d&&(i&&(d.styleIndex=i.index),i||!t.values[u][f+n-1]?t.values[u][f+n-1]=d:(t.values[u][f+n-1].value=d.value,t.values[u][f+n-1].type=d.type))}}else{var d=o(e[a],t);d&&(i&&(d.styleIndex=i.index),i||!t.values[u][n-1]?t.values[u][n-1]=d:(t.values[u][n-1].value=d.value,t.values[u][n-1].type=d.type))}}},a=function(e,t,r,n,l){var s=String.fromCharCode(65+n-1)+r,a=r-1;if(void 0!==e&&null!==e){if(t.values[a]||(t.values[a]=[]),e=o(e,t),l){l.cellIndex=s;var u=t._workBook.createStyles();e.styleIndex=u.addStyles(l).index}!e.styleIndex&&t.values[a][n-1]&&(e.styleIndex=t.values[a][n-1].styleIndex),t.values[a][n-1]=e}return i(t,s,a,n-1)},i=function(e,t,r,n){return{style:function(l){return l.cellIndex=t,f(e,l,r,n),i(e,t,r,n)},value:e.values[r]&&e.values[r][n]?e.values[r][n].value:null,type:e.values[r]&&e.values[r][n]?e.values[r][n].type:null,cellIndex:t,rowIndex:r+1,columnIndex:String.fromCharCode(65+n),set:function(l,o){return v(e,r+1,n+1,l,o),this.value=e.values[r]&&e.values[r][n]?e.values[r][n].value:null,this.type=e.values[r]&&e.values[r][n]?e.values[r][n].type:null,i(e,t,r,n)}}},u=function(e,t,r,n,l,o,s,a,c){var m,h=[];for(m=0;m<r.length;m++){var p=r[m].rowIndex,g=r[m].columnIndex,b=e.values[p]&&e.values[p][g]?e.values[p][g].value:null,x=e.values[p]&&e.values[p][g]?e.values[p][g].type:null,_=String.fromCharCode(65+g)+(p+1);h.push({style:function(t){return t.cellIndex=_,f(e,t,p,g),i(e,_,p,g)},rowIndex:p,columnIndex:String.fromCharCode(65+g),value:b,cellIndex:_,type:x,set:function(t,r){return v(e,p+1,g+1,t,r),this.value=e.values[p]&&e.values[p][g]?e.values[p][g].value:null,this.type=e.values[p]&&e.values[p][g]?e.values[p][g].type:null,i(e,_,p,g)}})}return{style:function(a){return a.cellIndices=t,d(e,a,r),u(e,t,r,n,l,o,s)},cellIndices:t,cells:h,set:function(i,f){var d=[];if(!(i&&i.length&&s&&o))return u(e,t,r,n,l,o,s);if(a||c)for(var m=0;m<this.cells.length&&m<i.length;m++)d.push(i[m]);if(a)i=[d];else if(c)i=d;else{for(var d=[],m=0;m<i.length&&m<o;m++){var v=[];if(i[m].length>s){for(var h=0;h<i[m].length&&h<s;h++)v.push(i[m][h]);i[m]=v}d.push(i[m])}i=d}y(e,n,l,o,s,i,f,!1,a,c);var p=u(e,t,r,n,l,o,s);return this.cells=p.cells,p}}},f=function(e,t,r,n){var l=e._workBook.createStyles(),o=l.addStyles(t).index;e.values[r]||(e.values[r]=[]),e.values[r][n]||(e.values[r][n]={value:"",type:"string"}),e.values[r][n].styleIndex=o},d=function(e,t,r){for(var n=e._workBook.createStyles(),l=n.addStyles(t).index,o=0;o<r.length;o++)e.values[r[o].rowIndex]||(e.values[r[o].rowIndex]=[]),e.values[r[o].rowIndex][r[o].columnIndex]||(e.values[r[o].rowIndex][r[o].columnIndex]={type:"string",value:""}),e.values[r[o].rowIndex][r[o].columnIndex].styleIndex=l},c=function(e,t,r,n,l){var o,s=[],a=[];if(r&&t&&n){var i;if("object"==typeof t&&!t.length){if("formula"!==t.type)return;i=t.value,t=t.formula}var f=r.match(/\D+/)[0],d=r.match(/\d+/)[0];if(e._sharedFormula){o=e._sharedFormula[e._sharedFormula.length-1].si+1}else e._sharedFormula=[],o=0;e._sharedFormula.push({si:o,fromCell:r,toCell:n,formula:t});var c=f.toUpperCase().charCodeAt()-65,m=parseInt(d,10);e.values[m-1]||(e.values[m-1]=[]),e.values[m-1][c]={type:"sharedFormula",si:o,formula:t,range:r+":"+n,value:i},s.push(String.fromCharCode(65+c)+m),a.push({rowIndex:m-1,columnIndex:c});var v,y;if(n&&(v=n.match(/\D+/)[0],y=n.match(/\d+/)[0]),y===d){var h=v.toUpperCase().charCodeAt()-65;for(c++;c<=h;c++)e.values[m-1][c]={type:"sharedFormula",si:o,value:i},s.push(String.fromCharCode(65+c)+m),a.push({rowIndex:m-1,columnIndex:c})}else if(v===f){var p=parseInt(y,10);for(m++;m<=p;m++)e.values[m-1]||(e.values[m-1]=[]),s.push(String.fromCharCode(65+c)+m),a.push({rowIndex:m-1,columnIndex:c}),e.values[m-1][c]={type:"sharedFormula",si:o,value:i}}if(l){l.cellIndices=s;var g;g=e._workBook.createStyles().addStyles(l);for(var b=0;b<a.length;b++)e.values[a[b].rowIndex][a[b].columnIndex].styleIndex=g.index}return u(e,s,a)}},m=function(e){delete e.sheetName,delete e.sheetId,delete e.rId,delete e.values,delete e._workBook,delete e._sharedFormula},v=function(e,t,r,n,l){if(t&&r&&"number"==typeof t&&"number"==typeof r){if(l||void 0!==n&&null!==n)return l||"object"!=typeof n||n.type||void 0!==n.value&&null!==n.value?void 0===n||null===n?h(e,t,r,l):a(n,e,t,r,l):h(e,t,r,n);var o=String.fromCharCode(65+r-1)+t;return i(e,o,t-1,r-1)}},y=function(e,t,r,n,l,o,a,i,f,c){if(t&&r&&"number"==typeof t&&"number"==typeof r&&"number"==typeof n&&"number"==typeof l){for(var m=[],v=[],y=n,h=t-1;y>0;h++,y--){var p=l;e.values[h]||(e.values[h]=[]);for(var g=r-1;p>0;g++,p--)v.push(String.fromCharCode(65+g)+(h+1)),m.push({rowIndex:h,columnIndex:g})}if(a||o){if(a||!o||o.length){if(void 0===o||null===o){if(a.cellIndices=v,d(e,a,m),!i)return;return u(e,v,m,t,r,n,l,f,c)}if(s(o,e,t,r,a,v),!i)return;return u(e,v,m,t,r,n,l,f,c)}if(o.cellIndices=v,d(e,o,m),!i)return;return u(e,v,m,t,r,n,l,f,c)}return u(e,v,m,t,r,n,l,f,c)}},h=function(e,t,r,n){var l=String.fromCharCode(65+r-1)+t;return n.cellIndex=l,f(e,n,t-1,r-1),i(e,l,t-1,r-1)},p=function(r,n,l,o,s,a){for(var i=[],u=o.match(/\D+/)[0].toUpperCase().charCodeAt()-65,f=parseInt(o.match(/\d+/)[0],10),d=s.match(/\D+/)[0].toUpperCase().charCodeAt()-65,c=r.values[f-1],m=u;m<=d;m++)i.push(c[m].value||"");r._rels||(r._rels=t.createRelation("sheet"+r.sheetId+".xml.rels","workbook/sheets/_rels"));var v=g(r);r._rels.addRelation("rId"+v,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table","../tables/table"+v+".xml"),n.addContentType("Override","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml",{PartName:"/workbook/tables/table"+v+".xml"}),r.tables||(r.tables=[]);var y=e.addTable(l,o,s,i,v,a,r);return r.tables.push(y),y},g=function(e){var t={};return e._rels.relations.length&&(t=e._rels.relations[e._rels.relations.length-1]),parseInt((t.Id||"rId0").replace("rId",""),10)+1};return{createSheet:function(e,t,r,o,s){var a={sheetName:e,sheetId:t,rId:r,values:[],_workBook:o};return{_sheet:a,generateContent:function(){n(a)},attach:function(e){l(a,e)},sharedFormula:function(e,t,r,n){return c(a,r,e,t,n)},cell:function(e,t,r,n){return v(a,e,t,r,n)},row:function(e,t,r,n){var l=a.values[e-1]?a.values[e-1].length-t+1:0;return y(a,e,t,1,r?r.length:l,r?[r]:null,n,!0,!0,!1)},column:function(e,t,r,n){var l=0;return r&&r.length||(l=a.values&&a.values.length&&a.values.length>e?a.values.length-e+1:0),y(a,e,t,r?r.length:l,1,r,n,!0,!1,!0)},grid:function(e,t,r,n){var l,o=0,s=0;if(r&&r.length)for(o=r.length,l=0;l<r.length;l++)r[l]&&r[l].length&&(s=s<r[l].length?r[l].length:s);else if(a.values&&a.values.length){o=a.values.length-e+1;for(var l=0;l<a.values.length;l++)a.values[l]&&a.values[l].length&&(s=s<a.values[l].length-t+1?a.values[l].length-t+1:s)}return y(a,e,t,o,s,r,n,!0,!1)},table:function(e,t,r,n){return p(a,s,e,t,r,n).tableOptions()},destroy:function(){return m(a)}}}}}),l("utils",[],function(){return sortObject=function(e){if("object"!=typeof e||e.length)return e;var t={},r=[];for(var n in e)r.push(n);r.sort();for(var l in r)t[r[l]]=sortObject(e[r[l]]);return t},{stringify:function(e){return JSON.stringify(sortObject(e))}}}),l("oxml_xlsx_font",["utils"],function(e){var t=function(e){var t,n="";n+='<fonts count="'+e._fontsCount+'">';for(t in e._fonts){var l=JSON.parse(t);n+=r(l)}return n+="</fonts>"},r=function(e){var t="<font>";return t+=e.strike?"<strike/>":"",t+=e.italic?"<i/>":"",t+=e.bold?"<b/>":"",t+=e.underline?"<u/>":"",t+=e.size?'<sz val="'+e.size+'"/>':"",t+=e.color?'<color rgb="'+e.color+'"/>':"",t+=e.name?'<name val="'+e.name+'"/>':"",t+=e.family?'<family val="'+e.family+'"/>':"",t+=e.scheme?'<scheme val="'+e.scheme+'"/>':"",t+="</font>"},n=function(e){var t={};return t.bold=!!e.bold,t.italic=!!e.italic,t.underline=!!e.underline,t.size=e.fontSize||!1,t.color=e.fontColor||!1,t.name=e.fontName||!1,t.family=e.fontFamily||!1,t.scheme=e.scheme||!1,t.strike=!!e.strike,t},l=function(t,r){return r._fonts[e.stringify(t)]},o=function(e,t){for(var r,n=0,l=0,o=0;o<t.length;o++)for(var s=t[0];n<e.styles.length;n++)if((void 0!==e.styles[n].cellIndices[s]||null!==e.styles[n].cellIndices[s])&&(r=e.styles[n],l++,Object.keys(r.cellIndices).length!==t.length||l>1||0===r._font))return!1;return!!r&&r._font},s=function(t,r){r._fonts||(r._fonts={},r._fontsCount=0);var n=r._fontsCount++;return r._fonts[e.stringify(t)]=""+n,r._fonts[e.stringify(t)]},a=function(t,r,n){return i(t,r,n,!0),n._fonts[e.stringify(t)]=r,r},i=function(t,r,n,l){var o;for(var s in n._fonts)if(n._fonts[s]===r){o=JSON.parse(s);break}l&&delete n._fonts[e.stringify(o)];for(var s in t)t[s]&&(o[s]=t[s]),t[s]=o[s];return t},u=function(e,t){var r,n=0;for(r=0;r<t.styles.length;r++)if(t.styles[r]._font===e&&(n+=Object.keys(t.styles[r].cellIndices).length)>1)return n;return n},f=function(e,t){var r,i=!1,u=n(t),f=e._fonts?l(u,e):null;return void 0!==f&&null!==f?r=f:i=!0,r||!1!==(f=o(e,t.cellIndices))&&(r=a(u,f,e)),void 0!==r&&null!==r||(r=s(u,e)),{font:u,fontIndex:r,newStyleCreated:i}};return{createFont:n,getFontForCell:function(e,t,r){var o,f=!1,d=n(t),c=e._fonts?l(d,e):null;if(void 0!==c&&null!==c?o=c:f=!0,r&&r._font){u(r._font,e)<=1?o=a(d,r._font,e):(d=i(d,r._font,e),c=l(d,e),void 0!==c&&null!==c?o=c:(o=null,f=!0))}return void 0!==o&&null!==o||(o=s(d,e)),{font:d,fontIndex:o,newStyleCreated:f}},getFontForCells:f,generateContent:t,generateSingleContent:r}}),l("oxml_xlsx_num_format",["utils"],function(e){var t=function(e){var t="";if(e._numFormats){t+='<numFmts count="'+Object.keys(e._numFormats).length+'">';var r;for(r in e._numFormats){var n=JSON.parse(r);t+='<numFmt numFmtId="'+e._numFormats[r]+'" formatCode="'+n.formatString+'"/>'}t+="</numFmts>"}return t},r=function(e){var t={};return t.formatString=e.numberFormat,t},n=function(t,r){return r._numFormats[e.stringify(t)]},l=function(t,r){r._numFormats||(r._numFormats={},r._numFormatsCount=200);var n=r._numFormatsCount++;return r._numFormats[e.stringify(t)]=""+n,r._numFormats[e.stringify(t)]},o=function(t,r,n){var l;for(var o in n._numFormats)if(n._numFormats[o]===r){l=JSON.parse(o);break}return t.formatString?(delete n._numFormats[e.stringify(l)],n._numFormats[e.stringify(t)]=r):t.formatString=l.formatString,r},s=function(e,t){var r,n=0;for(r=0;r<t.styles.length;r++)if(t.styles[r]._numFormat===e&&(n+=Object.keys(t.styles[r].cellIndices).length)>1)return n;return n},a=function(e,t){for(var r,n=0,l=0,o=0;o<t.length;o++)for(var s=t[0];n<e.styles.length;n++)if((void 0!==e.styles[n].cellIndices[s]||null!==e.styles[n].cellIndices[s])&&(r=e.styles[n],l++,Object.keys(r.cellIndices).length!==t.length||l>1))return!1;return!!r&&r._numFormat},i=function(e,t){var s,i=!1,u=r(t),f=e._numFormats?n(u,e):null;return void 0!==f&&null!==f?s=f:u.formatString&&(i=!0),s||!1!==(f=a(e,t.cellIndices))&&(s=o(u,f,e)),void 0!==s&&null!==s||!u.formatString||(s=l(u,e)),{numFormat:u,numFormatIndex:s||!1,newStyleCreated:i}};return{generateContent:t,getNumFormatForCell:function(e,t,a){var i,u=!1,f=r(t),d=e._numFormats?n(f,e):null;if(void 0!==d&&null!==d?i=d:f.formatString&&(u=!0),a&&a._numFormat){s(a._numFormat,e)<=1&&e._numFormats&&(i=o(f,a._numFormat,e))}return void 0!==i&&null!==i||!f.formatString||(i=l(f,e)),{numFormat:f,numFormatIndex:i||!1,newStyleCreated:u}},getNumFormatForCells:i}}),l("oxml_xlsx_border",["utils"],function(e){var t=function(e,t){if(e.style||e.color){return"<"+t+" "+(e.style?' style="'+e.style+'" ':"")+">"+(e.color?'<color rgb="'+e.color+'"/>':"")+"</"+t+">"}return"<"+t+"/>"},r=function(e){var t,r="";r+='<borders count="'+e._bordersCount+'">';for(t in e._borders){var l=JSON.parse(t);r+=l?n(l):"<border />"}return r+="</borders>"},n=function(e){var r="<border>";return r+=t(e.left,"left"),r+=t(e.right,"right"),r+=t(e.top,"top"),r+=t(e.bottom,"bottom"),r+=t(e.diagonal,"diagonal"),r+="</border>"},l=function(e){var t={};return!!e.border&&(t.left={color:!!e.border.left&&e.border.left.color||e.border.color||!1,style:!!e.border.left&&e.border.left.style||e.border.style||!1},t.top={color:!!e.border.top&&e.border.top.color||e.border.color||!1,style:!!e.border.top&&e.border.top.style||e.border.style||!1},t.bottom={color:!!e.border.bottom&&e.border.bottom.color||e.border.color||!1,style:!!e.border.bottom&&e.border.bottom.style||e.border.style||!1},t.right={color:!!e.border.right&&e.border.right.color||e.border.color||!1,style:!!e.border.right&&e.border.right.style||e.border.style||!1},t.diagonal={color:!!e.border.diagonal&&e.border.diagonal.color||e.border.color||!1,style:!!e.border.diagonal&&e.border.diagonal.style||e.border.style||!1},t.isValid=t.left.style||t.top.style||t.bottom.style||t.right.style||t.diagonal.style||t.left.color||t.top.color||t.bottom.color||t.right.color||t.diagonal.color,!!t.isValid&&t)},o=function(t,r){return r._borders[e.stringify(t)]},s=function(t,r){r._borders||(r._borders={},r._bordersCount=0);var n=r._bordersCount++;return r._borders[e.stringify(t)]=""+n,r._borders[e.stringify(t)]},a=function(e,t){for(var r,n=0,l=0,o=0;o<t.length;o++)for(var s=t[0];n<e.styles.length;n++)if((void 0!==e.styles[n].cellIndices[s]||null!==e.styles[n].cellIndices[s])&&(r=e.styles[n],l++,Object.keys(r.cellIndices).length!==t.length||l>1||0===r._border))return!1;return!!r&&r._border},i=function(t,r,n){return u(t,r,n,!0),n._borders[e.stringify(t)]=r,r},u=function(t,r,n,l){var o;for(var s in n._borders)if(n._borders[s]===r){o=JSON.parse(s);break}if(l&&delete n._borders[e.stringify(o)],t)for(var s in t)(t[s].color||t[s].style)&&(o[s]=t[s]),t[s]=o[s];else t=o;return t},f=function(e,t){var r,n=0;for(r=0;r<t.styles.length;r++)if(t.styles[r]._border===e&&(n+=Object.keys(t.styles[r].cellIndices).length)>1)return n;return n};return{createBorder:l,getBorderForCell:function(e,t,r){var n,a=!1,d=l(t),c=e._borders?o(d,e):null;if(void 0!==c&&null!==c?n=c:a=!0,r&&r._border&&r._border!==c){f(r._border,e)<=1&&(n=i(d,r._border,e))}return void 0!==n&&null!==n||(r&&r._border&&(d=u(d,r._border,e,!1)),n=s(d,e)),{border:d,borderIndex:n,newStyleCreated:a}},getBorderForCells:function(e,t){var r,n=!1,u=l(t),f=e._borders?o(u,e):null;return void 0!==f&&null!==f?r=f:n=!0,f=a(e,t.cellIndices),!1!==f&&(r=i(u,f,e)),void 0!==r&&null!==r||(r=s(u,e)),{border:u,borderIndex:r,newStyleCreated:n}},generateContent:r,generateSingleContent:n}}),l("oxml_xlsx_fill",["utils"],function(e){var t=function(e){var t,n="";n+='<fills count="'+e._fillsCount+'">';for(t in e._fills){var l=JSON.parse(t);n+=l?r(l):"<fill/>"}return n+="</fills>"},r=function(e){var t="<fill>";if(e.pattern){var r=e.pattern||"none",n=e.fgColor?'<fgColor rgb="'+e.fgColor+'"/>':"";n+=e.bgColor?'<bgColor rgb="'+e.bgColor+'"/>':"",t+='<patternFill patternType="'+r+'">'+n+"</patternFill>"}else{if(!e.gradient)return"<fill/>";t+="<gradientFill "+(e.gradient.type?' type="'+e.gradient.type+'" ':"")+(e.gradient.left?' left="'+e.gradient.left+'" ':"")+(e.gradient.right?' right="'+e.gradient.right+'"':"")+(e.gradient.top?' top="'+e.gradient.top+'" ':"")+(e.gradient.bottom?' bottom="'+e.gradient.bottom+'" ':"")+(e.gradient.degree?' degree="'+e.gradient.degree+'" ':"")+" >";for(var l=0;l<e.gradient.stops.length;l++)t+='<stop position="'+e.gradient.stops[l].position+'">',t+='<color rgb="'+e.gradient.stops[l].color+'" /></stop>';t+="</gradientFill>"}return t+"</fill>"},n=function(e){if(e.fill&&e.fill.pattern){var t={};return t.pattern=e.fill.pattern,t.fgColor=e.fill.foreColor||!1,t.bgColor=e.fill.backColor||e.fill.color||!1,t}if(e.fill&&e.fill.gradient&&e.fill.gradient.stops){var t={};t.gradient={},t.gradient.degree=e.fill.gradient.degree||!1,t.gradient.bottom=e.fill.gradient.bottom||!1,t.gradient.left=e.fill.gradient.left||!1,t.gradient.right=e.fill.gradient.right||!1,t.gradient.top=e.fill.gradient.top||!1,t.gradient.type=e.fill.gradient.type||!1,t.gradient.stops=[];for(var r=0;r<e.fill.gradient.stops.length;r++){var n={};n.position=e.fill.gradient.stops[r].position||0,n.color=e.fill.gradient.stops[r].color||!1,t.gradient.stops.push(n)}return t}return!1},l=function(t,r){return r._fills[e.stringify(t)]},o=function(t,r){r._fills||(r._fills={},r._fillsCount=0);var n=r._fillsCount++;return r._fills[e.stringify(t)]=""+n,r._fills[e.stringify(t)]},s=function(e,t){for(var r,n=0,l=0,o=0;o<t.length;o++)for(var s=t[0];n<e.styles.length;n++)if((void 0!==e.styles[n].cellIndices[s]||null!==e.styles[n].cellIndices[s])&&(r=e.styles[n],l++,Object.keys(r.cellIndices).length!==t.length||l>1||0===r._fill))return!1;return!!r&&r._fill},a=function(t,r,n){return i(t,r,n,!0),n._fills[e.stringify(t)]=r,r},i=function(t,r,n,l){var o;for(var s in n._fills)if(n._fills[s]===r){o=JSON.parse(s);break}l&&delete n._fills[e.stringify(o)];for(var s in t)t[s]&&(o[s]=t[s]),t[s]=o[s];return t},u=function(e,t){var r,i=!1,u=n(t),f=e._fills?l(u,e):null;return void 0!==f&&null!==f?r=f:i=!0,r||!1!==(f=s(e,t.cellIndices))&&(r=a(u,f,e)),void 0!==r&&null!==r||(r=o(u,e)),{fill:u,fillIndex:r,newStyleCreated:i}},f=function(e,t){var r,n=0;for(r=0;r<t.styles.length;r++)if(t.styles[r]._fill===e&&(n+=Object.keys(t.styles[r].cellIndices).length)>1)return n;return n};return{createFill:n,generateContent:t,getFillForCell:function(e,t,r){var s,u=!1,d=n(t),c=e._fills?l(d,e):null;if(void 0!==c&&null!==c?s=c:u=!0,r&&r._fill){f(r._fill,e)<=1&&(s=a(d,r._fill,e))}return void 0!==s&&null!==s||(r&&r._fill&&(d=i(d,r._fill,e,!1)),s=o(d,e)),!s&&r&&r._fill&&(s=r._fill),{fill:d,fillIndex:s,newStyleCreated:u}},getFillForCells:u,generateSingleContent:r}}),l("oxml_xlsx_styles",["utils","oxml_xlsx_font","oxml_xlsx_num_format","oxml_xlsx_border","oxml_xlsx_fill"],function(e,t,r,n,l){var o=function(e){var o='<?xml version="1.0" encoding="utf-8" standalone="yes"?><styleSheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main">',a=0;for(o+=r.generateContent(e),o+=t.generateContent(e),o+=l.generateContent(e),o+=n.generateContent(e),o+='<cellStyleXfs count="1"><xf /></cellStyleXfs>',o+='<cellXfs count="'+(parseInt(e.styles.length,10)+1)+'"><xf />',a=0;a<e.styles.length;a++){var i=e.styles[a]._numFormat?' numFmtId="'+e.styles[a]._numFormat+'" ':"",u=e.styles[a]._border?' borderId="'+e.styles[a]._border+'" ':"",f=e.styles[a]._fill?' fillId="'+e.styles[a]._fill+'" ':"";o+='<xf fontId="'+e.styles[a]._font+'" '+i+u+f+" />"}var d="";return e.tableStyles&&e.tableStyles.length&&(d=s(e)),o+="</cellXfs>"+d+"</styleSheet>"},s=function(e){for(var t,r=0,n="",l=0,o=0;o<e.tableStyles.length;o++){var s,i="";r++,l++,t=1,i+=a(e.tableStyles[o]),s='<tableStyleElement dxfId="'+(r-1)+'" type="wholeTable"/>',e.tableStyles[o].evenColumn&&(r++,t++,s+='<tableStyleElement dxfId="'+(r-1)+'" type="secondColumnStripe"/>',i+=a(e.tableStyles[o].evenColumn)),e.tableStyles[o].oddColumn&&(r++,t++,
s+='<tableStyleElement dxfId="'+(r-1)+'" type="firstColumnStripe"/>',i+=a(e.tableStyles[o].oddColumn)),e.tableStyles[o].evenRow&&(r++,t++,s+='<tableStyleElement dxfId="'+(r-1)+'" type="secondRowStripe"/>',i+=a(e.tableStyles[o].evenRow)),e.tableStyles[o].oddRow&&(r++,t++,s+='<tableStyleElement dxfId="'+(r-1)+'" type="firstRowStripe"/>',i+=a(e.tableStyles[o].oddRow)),e.tableStyles[o].firstColumn&&(r++,t++,s+='<tableStyleElement dxfId="'+(r-1)+'" type="firstColumn"/>',i+=a(e.tableStyles[o].firstColumn)),e.tableStyles[o].lastColumn&&(r++,t++,s+='<tableStyleElement dxfId="'+(r-1)+'" type="lastColumn"/>',i+=a(e.tableStyles[o].lastColumn)),e.tableStyles[o].firstRow&&(r++,t++,s+='<tableStyleElement dxfId="'+(r-1)+'" type="headerRow"/>',i+=a(e.tableStyles[o].firstRow)),e.tableStyles[o].lastRow&&(r++,t++,s+='<tableStyleElement dxfId="'+(r-1)+'" type="totalRow"/>',i+=a(e.tableStyles[o].lastRow)),e.tableStyles[o].firstRowFirstCell&&(r++,t++,s+='<tableStyleElement dxfId="'+(r-1)+'" type="firstHeaderCell"/>',i+=a(e.tableStyles[o].firstRowFirstCell)),e.tableStyles[o].firstRowLastCell&&(r++,t++,s+='<tableStyleElement dxfId="'+(r-1)+'" type="lastHeaderCell"/>',i+=a(e.tableStyles[o].firstRowLastCell)),e.tableStyles[o].lastRowFirstCell&&(r++,t++,s+='<tableStyleElement dxfId="'+(r-1)+'" type="firstTotalCell"/>',i+=a(e.tableStyles[o].lastRowFirstCell)),e.tableStyles[o].lastRowLastCell&&(r++,t++,s+='<tableStyleElement dxfId="'+(r-1)+'" type="lastTotalCell"/>',i+=a(e.tableStyles[o].lastRowLastCell)),n+='<tableStyle count="'+t+'" name="'+e.tableStyles[o].name+'">'+s+"</tableStyle>"}return n='<tableStyles count="'+l+'">'+n+"</tableStyles>",i='<dxfs count="'+r+'">'+i+"</dxfs>"+n},a=function(e){return dxfString="<dxf>",e.font&&(dxfString+=t.generateSingleContent(e.font)),e.fill&&(dxfString+=l.generateSingleContent(e.fill)),e.border&&(dxfString+=n.generateSingleContent(e.border)),dxfString+="</dxf>",dxfString},i=function(e,t){var r=o(t);e.addFile(r,t.fileName,"workbook")},u=function(e,t,r){var n=e.getLastSheet(),l=parseInt((n.Id||"rId0").replace("rId",""),10)+1;return r.addContentType("Override","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",{PartName:"/workbook/style"+l+".xml"}),t.addRelation("rId"+l,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles","style"+l+".xml"),l},f=function(e,t){for(var r=0;r<e.styles.length;r++)if(void 0!==e.styles[r].cellIndices[t]&&null!==e.styles[r].cellIndices[t])return e.styles[r];return null},d=function(e,t){for(var r=0;r<e.styles.length;r++)if(e.styles[r]._font===t._font&&e.styles[r]._numFormat===t._numFormat)return e.styles[r];return null},c=function(e,o){if(e.cellIndex||e.cellIndices){var s,a,i,u,c,m=!1;if(e.cellIndex){if(s=f(o,e.cellIndex),a=t.getFontForCell(o,e,s),i=r.getNumFormatForCell(o,e,s),u=n.getBorderForCell(o,e,s),c=l.getFillForCell(o,e,s),m=m||a.newStyleCreated||u.newStyleCreated||c.newStyleCreated,s){if(s._font===a.fontIndex&&s._numFormat===i.numFormatIndex&&s._border===u.borderIndex&&s._fill===c.fillIndex)return s;if(1===Object.keys(s.cellIndices).length)return s._font=a.fontIndex,s._numFormat=i.numFormatIndex,s._border=u.borderIndex,s._fill=c.fillIndex,s;delete s.cellIndices[e.cellIndex]}return!m&&(s=d(o,{_font:a.fontIndex,_numFormat:i.numFormatIndex,_border:u.borderIndex,_fill:c.fillIndex}))?(s.cellIndices[e.cellIndex]=Object.keys(s.cellIndices).length,s):(s={_font:a.fontIndex,_numFormat:i.numFormatIndex||!1,_border:u.borderIndex,_fill:c.fillIndex,cellIndices:{}},s.cellIndices[e.cellIndex]=0,s.index=""+(parseInt(o.styles.length,10)+1),o.styles.push(s),s)}if(e.cellIndices){var v;if(a=t.getFontForCells(o,e),i=r.getNumFormatForCells(o,e),u=n.getBorderForCells(o,e),c=l.getFillForCells(o,e),!(m=m||a.newStyleCreated||i.newStyleCreated||u.newStyleCreated||c.newStyleCreated)&&(s=d(o,{_font:a.fontIndex,_numFormat:i.numFormatIndex,_border:u.borderIndex,_fill:c.fillIndex}))){for(v=0;v<e.cellIndices.length;v++){var y=e.cellIndices[v],h=f(o,y);delete h.cellIndices[y],s.cellIndices[y]=Object.keys(s.cellIndices).length}return s}for(s={_font:a.fontIndex,_numFormat:i.numFormatIndex,_border:u.borderIndex,_fill:c.fillIndex,cellIndices:{}},v=0;v<e.cellIndices.length;v++){var y=e.cellIndices[v],h=f(o,y);if(h&&delete h.cellIndices[y],s.cellIndices[y]=Object.keys(s.cellIndices).length,h&&!Object.keys(h.cellIndices).length){for(key in s)h[key]=s[key];return h}}return s.index=""+(parseInt(o.styles.length,10)+1),o.styles.push(s),s}}},m=function(e,t,r){r.tableStyles||(r.tableStyles=[]);var n=v(e);return n.name=t,e.evenColumn&&(n.evenColumn=v(e.evenColumn)),e.oddColumn&&(n.oddColumn=v(e.oddColumn)),e.evenRow&&(n.evenRow=v(e.evenRow)),e.oddRow&&(n.oddRow=v(e.oddRow)),e.firstColumn&&(n.firstColumn=v(e.firstColumn)),e.lastColumn&&(n.lastColumn=v(e.lastColumn)),e.firstRow&&(n.firstRow=v(e.firstRow)),e.lastRow&&(n.lastRow=v(e.lastRow)),e.firstRowFirstCell&&(n.firstRowFirstCell=v(e.firstRowFirstCell)),e.firstRowLastCell&&(n.firstRowLastCell=v(e.firstRowLastCell)),e.lastRowFirstCell&&(n.lastRowFirstCell=v(e.lastRowFirstCell)),e.lastRowLastCell&&(n.lastRowLastCell=v(e.lastRowLastCell)),r.tableStyles.push(n),n},v=function(e){var r={};return r.font=t.createFont(e),r.fill=l.createFill(e),r.border=n.createBorder(e),r};return{createStyle:function(t,r,n){var l=u(t,r,n),s={sheetId:l,fileName:"style"+l+".xml",styles:[],_fonts:{},_borders:{},_fills:{},_fontsCount:1,_bordersCount:1,_fillsCount:2},a={bold:!1,italic:!1,underline:!1,size:!1,color:!1,strike:!1,family:!1,name:!1,scheme:!1};s._fonts[e.stringify(a)]=0,s._borders[!1]=0,s._fills[!1]=0;var f={pattern:"gray125",fgColor:!1,bgColor:!1};return s._fills[e.stringify(f)]=1,{_styles:s,generateContent:function(){return o(s)},attach:function(e){i(e,s)},addStyles:function(e){return c(e,s)},addTableStyle:function(e,t){return m(e,t,s)}}}}}),l("oxml_workbook",["oxml_content_types","oxml_rels","oxml_sheet","oxml_xlsx_styles"],function(e,t,r,n){"use strict";var l=function(e){return e._rels.relations.length?e._rels.relations[e._rels.relations.length-1]:{}},o=function(e,t){var r,n='<workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"><sheets>';for(r=0;r<e.sheets.length;r++)n+='<sheet name="'+e.sheets[r]._sheet.sheetName+'" sheetId="'+e.sheets[r]._sheet.sheetId+'" r:id="'+e.sheets[r]._sheet.rId+'" />',t&&e.sheets[r].attach(t);return n+="</sheets></workbook>"},s=function(e){if(e._sharedStrings&&Object.keys(e._sharedStrings).length){var t='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><sst xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main">';for(var r in e._sharedStrings)t+="<si><t>"+r+"</t></si>";return t+="</sst>"}return""},a=function(e,t,n){var o=l(e),s=parseInt((o.Id||"rId0").replace("rId",""),10)+1;t=t||"sheet"+s,e._rels.addRelation("rId"+s,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","sheets/sheet"+s+".xml");var a=r.createSheet(t,s,"rId"+s,e,n);return e.sheets.push(a),e.xlsxContentTypes.addContentType("Override","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",{PartName:"/workbook/sheets/sheet"+s+".xml"}),a},i=function(e,t){t._rels.attach(e);var r=o(t,e);e.addFile(r,"workbook.xml","workbook");var n=s(t);n&&e.addFile(n,"sharedstrings.xml","workbook"),t._styles&&t._styles.attach(e)},u=function(e,t){if(e){if(!t._sharedStrings){t._sharedStrings={},t.xlsxContentTypes.addContentType("Override","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",{PartName:"/workbook/sharedstrings.xml"});var r=l(t),n=parseInt((r.Id||"rId0").replace("rId",""),10)+1;t._rels.addRelation("rId"+n,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings","sharedstrings.xml")}return isNaN(t._sharedStrings[e])&&(t._sharedStrings[e]=Object.keys(t._sharedStrings).length||0),t._sharedStrings[e]}},f=function(e,t){return t._sharedStrings[e]},d=function(e){var t;for(delete e.xlsxContentTypes,delete e.xlsxRels,e._rels.destroy(),e._rels.destroy=null,delete e._rels.destroy,e._rels=null,delete e._rels,e.generateContent=null,delete e.generateContent,e.attach=null,delete e.attach,e.addSheet=null,delete e.addSheet,e.createSharedString=null,delete e.createSharedString,e.getSharedString=null,delete e.getSharedString,e._sharedStrings=null,delete e._sharedStrings,t=0;t<e.sheets.length;t++)e.sheets[t].destroy(),e.sheets[t].destroy=null,delete e.sheets[t].destroy,e.sheets[t]=null;e.sheets=null,delete e.sheets};return{createWorkbook:function(e,r){var s={sheets:[],xlsxContentTypes:e,xlsxRels:r};return s._rels=t.createRelation("workbook.xml.rels","workbook/_rels"),s.addSheet=function(t){return a(s,t,e)},s.generateContent=function(){return o(s)},s.attach=function(e){i(e,s)},s.createSharedString=function(e){return u(e,s)},s.getSharedString=function(e){return f(e,s)},s.destroy=function(){d(s)},s.createStyles=function(){return s._styles||(s._styles=n.createStyle(s,s._rels,e)),s._styles},s.getLastSheet=function(){return l(s)},s}}}),l("oxml_xlsx",["fileHandler","oxml_content_types","oxml_rels","oxml_workbook"],function(r,n,l,o){"use strict";var s={},a=function(n,l,o){try{var s,a;if("undefined"==typeof window)s=e(),a=t;else if("undefined"==typeof JSZip){if(l)l("Err: JSZip reference not found.");else if("undefined"!=typeof Promise)return new Promise(function(e,t){t("Err: JSZip reference not found.")})}else s=new JSZip;var i=r.createFile(s,a);return o.contentTypes.attach(i),o._rels.attach(i),o.workBook.attach(i),i.saveFile(n,l)}catch(e){if(l)l("Err: Not able to create Workbook.");else if("undefined"!=typeof Promise)return new Promise(function(e,t){t("Err: Not able to create Workbook.")})}},i=function(){var e={};e.contentTypes=n.createContentType(),e.contentTypes.addContentType("Default","application/vnd.openxmlformats-package.relationships+xml",{Extension:"rels"}),e.contentTypes.addContentType("Default","application/xml",{Extension:"xml"}),e.contentTypes.addContentType("Override","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",{PartName:"/workbook/workbook.xml"}),e._rels=l.createRelation(".rels","_rels"),e._rels.addRelation("rId1","http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument","workbook/workbook.xml"),e.workBook=o.createWorkbook(e.contentTypes,e._rels);var t=function(t,r){return a(t,r,e)},r=function(){e.workBook.destroy(),delete e.workBook,e._rels.destroy(),delete e._rels,e.contentTypes.destroy(),delete e.contentTypes,e=null};return{_xlsx:e,sheet:e.workBook.addSheet,download:t,destroy:r}};return s.xlsx=i,"undefined"==typeof window||window.oxml||(window.oxml=s),s}),n("oxml_xlsx")});