!function(e,t){e.oxml=function(){var e,t,r;return function(n){function l(e,t){return _.call(e,t)}function o(e,t){var r,n,l,o,s,i,a,u,f,d,c,m=t&&t.split("/"),v=h.map,y=v&&v["*"]||{};if(e){for(s=(e=e.split("/")).length-1,h.nodeIdCompat&&b.test(e[s])&&(e[s]=e[s].replace(b,"")),"."===e[0].charAt(0)&&m&&(e=m.slice(0,m.length-1).concat(e)),f=0;f<e.length;f++)if("."===(c=e[f]))e.splice(f,1),f-=1;else if(".."===c){if(0===f||1===f&&".."===e[2]||".."===e[f-1])continue;f>0&&(e.splice(f-1,2),f-=2)}e=e.join("/")}if((m||y)&&v){for(f=(r=e.split("/")).length;f>0;f-=1){if(n=r.slice(0,f).join("/"),m)for(d=m.length;d>0;d-=1)if((l=v[m.slice(0,d).join("/")])&&(l=l[n])){o=l,i=f;break}if(o)break;!a&&y&&y[n]&&(a=y[n],u=f)}!o&&a&&(o=a,i=u),o&&(r.splice(0,i,o),e=r.join("/"))}return e}function s(e,t){return function(){var r=x.call(arguments,0);return"string"!=typeof r[0]&&1===r.length&&r.push(null),c.apply(n,r.concat([e,t]))}}function i(e){return function(t){y[e]=t}}function a(e){if(l(g,e)){var t=g[e];delete g[e],p[e]=!0,d.apply(n,t)}if(!l(y,e)&&!l(p,e))throw new Error("No "+e);return y[e]}function u(e){var t,r=e?e.indexOf("!"):-1;return r>-1&&(t=e.substring(0,r),e=e.substring(r+1,e.length)),[t,e]}function f(e){return e?u(e):[]}var d,c,m,v,y={},g={},h={},p={},_=Object.prototype.hasOwnProperty,x=[].slice,b=/\.js$/;m=function(e,t){var r,n=u(e),l=n[0],s=t[1];return e=n[1],l&&(r=a(l=o(l,s))),l?e=r&&r.normalize?r.normalize(e,function(e){return function(t){return o(t,e)}}(s)):o(e,s):(l=(n=u(e=o(e,s)))[0],e=n[1],l&&(r=a(l))),{f:l?l+"!"+e:e,n:e,pr:l,p:r}},v={require:function(e){return s(e)},exports:function(e){var t=y[e];return void 0!==t?t:y[e]={}},module:function(e){return{id:e,uri:"",exports:y[e],config:function(e){return function(){return h&&h.config&&h.config[e]||{}}}(e)}}},d=function(e,t,r,o){var u,d,c,h,_,x,b,I=[],C=typeof r;if(o=o||e,x=f(o),"undefined"===C||"function"===C){for(t=!t.length&&r.length?["require","exports","module"]:t,_=0;_<t.length;_+=1)if(h=m(t[_],x),"require"===(d=h.f))I[_]=v.require(e);else if("exports"===d)I[_]=v.exports(e),b=!0;else if("module"===d)u=I[_]=v.module(e);else if(l(y,d)||l(g,d)||l(p,d))I[_]=a(d);else{if(!h.p)throw new Error(e+" missing "+d);h.p.load(h.n,s(o,!0),i(d),{}),I[_]=y[d]}c=r?r.apply(y[e],I):void 0,e&&(u&&u.exports!==n&&u.exports!==y[e]?y[e]=u.exports:c===n&&b||(y[e]=c))}else e&&(y[e]=r)},e=t=c=function(e,t,r,l,o){if("string"==typeof e)return v[e]?v[e](t):a(m(e,f(t)).f);if(!e.splice){if((h=e).deps&&c(h.deps,h.callback),!t)return;t.splice?(e=t,t=r,r=null):e=n}return t=t||function(){},"function"==typeof r&&(r=l,l=o),l?d(n,e,t,r):setTimeout(function(){d(n,e,t,r)},4),c},c.config=function(e){return c(e)},e._defined=y,(r=function(e,t,r){if("string"!=typeof e)throw new Error("See almond README: incorrect module build, no module name");t.splice||(r=t,t=[]),l(y,e)||l(g,e)||(g[e]=[e,t,r])}).amd={jQuery:!0}}(),r("build/almond",function(){}),r("fileHandler",[],function(){"use strict";return{createFile:function(){if(window.JSZip){var e=new JSZip,t={_zip:e};return t.addFile=function(t,r,n){var l;n&&(l=e.folder(n)),(l||e).file(r,t)},t.saveFile=function(t,r){return e.generateAsync({type:"blob"}).then(function(e){try{if(window.saveAs)return saveAs(e,t);var n=window.URL.createObjectURL(e),l=document.createElement("a");if(l.setAttribute("href",n),l.setAttribute("download",t),l.style.display="none",document.body.appendChild(l),l.click(),document.body.removeChild(l),r)r();else if("undefined"!=typeof Promise)return new Promise(function(e,t){e()})}catch(e){if(r)r("Err: Not able to create file object.");else if("undefined"!=typeof Promise)return new Promise(function(e,t){t("Err: Not able to create file object.")})}})},t}}}}),r("oxml_rels",[],function(){"use strict";var e=function(e,t,r,n){n.relations.push({Id:e,Type:t,Target:r})},t=function(e){var t,r='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">';for(t=0;t<e.relations.length;t++){var n=e.relations[t];r+='<Relationship Id="'+n.Id+'" Type="'+n.Type+'" Target="'+n.Target+'"/>'}return r+="</Relationships>"},r=function(e,r){var n=t(r);e.addFile(n,r.fileName,r.folderName)},n=function(e){e.relations=null,delete e.relations,e.addRelation=null,delete e.addRelation,e.generateContent=null,delete e.generateContent,e.attach=null,delete e.attach};return{createRelation:function(l,o){var s={relations:[],fileName:l,folderName:o};return s.addRelation=function(t,r,n){e(t,r,n,s)},s.generateContent=function(){return t(s)},s.attach=function(e){return r(e,s)},s.destroy=function(){n(s)},s}}}),r("oxml_content_types",[],function(){"use strict";var e=function(e){var t,r='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types">';for(t=0;t<e.contentTypes.length;t++){var n=e.contentTypes[t];r+="<"+n.name+' ContentType="'+n.contentType+'" ',n.Extension&&(r+='Extension="'+n.Extension+'" '),n.PartName&&(r+='PartName="'+n.PartName+'" '),r+="/>\n"}return r+="</Types>"},t=function(t,r){var n=e(r);t.addFile(n,"[Content_Types].xml")},r=function(e,t,r,n){var l={name:e,contentType:t};for(var o in r)l[o]=r[o];n.contentTypes.push(l)},n=function(e){e.addContentType=null,delete e.addContentType,e.generateContent=null,delete e.generateContent,e.attach=null,delete e.attach,e.contentTypes=null,delete e.contentTypes};return{createContentType:function(){var l={contentTypes:[]};return l.addContentType=function(e,t,n){r(e,t,n,l)},l.generateContent=function(){return e(l)},l.attach=function(e){return t(e,l)},l.destroy=function(){n(l)},l}}}),r("oxml_sheet",[],function(){"use strict";var e=function(e,t,r,n){if(!e)return"";var l=e.styleIndex?' s="'+e.styleIndex+'" ':"";if("numeric"===e.type)return'<c r="'+t+'" '+l+"><v>"+e.value+"</v></c>";if("sharedString"===e.type)return'<c r="'+t+'" t="s" '+l+"><v>"+e.value+"</v></c>";if("sharedFormula"===e.type){var o="";return e.value&&"function"==typeof e.value?o="<v>"+e.value(r+1,n+1)+"</v>":void 0!==e.value&&null!==e.value&&(o="<v>"+e.value+"</v>"),e.formula?'<c  r="'+t+'" '+l+'><f t="shared" ref="'+e.range+'" si="'+e.si+'">'+e.formula+"</f>"+o+"</c>":'<c  r="'+t+'" '+l+'><f t="shared" si="'+e.si+'"></f>'+o+"</c>"}if("string"===e.type)return'<c r="'+t+'" t="inlineStr" '+l+"><is><t>"+e.value+"</t></is></c>";if("formula"===e.type){var o="";return e.value&&"function"==typeof e.value?o="<v>"+e.value(r+1,n+1)+"</v>":void 0!==e.value&&null!==e.value&&(o="<v>"+e.value+"</v>"),'<c r="'+t+'" '+l+"><f>"+e.formula+"</f>"+o+"</c>"}},t=function(t){var r=0,n="";if(t.values&&t.values.length)for(r=0;r<t.values.length;r++)if(t.values[r]&&t.values[r].length>0){n+='<row r="'+(r+1)+'">\n';var l=0;for(l=0;l<t.values[r].length;l++){var o=String.fromCharCode(65+l),s=t.values[r][l],i=o+(r+1),a=e(s,i,r,l);n+=a}n+="</row>"}return'<worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main"><sheetData>'+n+"</sheetData></worksheet>"},r=function(e,r){var n=t(e);r.addFile(n,"sheet"+e.sheetId+".xml","workbook/sheets")},n=function(e,t){if(void 0===e||null===e)return null;if("object"==typeof e){if(!(void 0!==e.value&&null!==e.value||e.formula&&"formula"===e.type))return null;if(e.type)return"sharedString"===e.type?"number"==typeof e.value?{type:e.type,value:e.value}:(e.value=t._workBook.createSharedString(e.value,t._workBook),{type:e.type,value:e.value}):"formula"===e.type?{type:e.type,formula:e.formula,value:e.value}:"numeric"===e.type||"string"===e.type?{type:e.type,value:e.value}:null;e=e.value}return"number"==typeof e?{type:"numeric",value:e}:"string"==typeof e?{type:"string",value:e}:"boolean"==typeof e?{type:"string",value:e+""}:null},l=function(e,t,r,l,o,s){var i,a;if(o){o.cellIndices=s;a=t._workBook.createStyles().addStyles(o)}for(i=0;i<e.length;i++)if(void 0!==e[i]||null!==e[i]){var u=i+r-1;if(t.values[u]||(t.values[u]=[]),"object"==typeof e[i]&&e[i].length>=0){var f;for(f=0;f<e[i].length;f++){var d=n(e[i][f],t);d&&(a&&(d.styleIndex=a.index),a||!t.values[u][f+l-1]?t.values[u][f+l-1]=d:(t.values[u][f+l-1].value=d.value,t.values[u][f+l-1].type=d.type))}}else{var d=n(e[i],t);d&&(a&&(d.styleIndex=a.index),a||!t.values[u][l-1]?t.values[u][l-1]=d:(t.values[u][l-1].value=d.value,t.values[u][l-1].type=d.type))}}},o=function(e,t,r,l,o){var i=String.fromCharCode(65+l-1)+r,a=r-1;if(void 0!==e&&null!==e){if(t.values[a]||(t.values[a]=[]),e=n(e,t),o){o.cellIndex=i;var u=t._workBook.createStyles();e.styleIndex=u.addStyles(o).index}!e.styleIndex&&t.values[a][l-1]&&(e.styleIndex=t.values[a][l-1].styleIndex),t.values[a][l-1]=e}return s(t,i,a,l-1)},s=function(e,t,r,n){return{style:function(l){return l.cellIndex=t,a(e,l,r,n),s(e,t,r,n)},value:e.values[r]&&e.values[r][n]?e.values[r][n].value:null,type:e.values[r]&&e.values[r][n]?e.values[r][n].type:null,cellIndex:t,rowIndex:r+1,columnIndex:String.fromCharCode(65+n),set:function(l,o){return c(e,r+1,n+1,l,o),this.value=e.values[r]&&e.values[r][n]?e.values[r][n].value:null,this.type=e.values[r]&&e.values[r][n]?e.values[r][n].type:null,s(e,t,r,n)}}},i=function(e,t,r,n,l,o,f,d,v){var y,g=[];for(y=0;y<r.length;y++){var h=r[y].rowIndex,p=r[y].columnIndex,_=e.values[h]&&e.values[h][p]?e.values[h][p].value:null,x=e.values[h]&&e.values[h][p]?e.values[h][p].type:null,b=String.fromCharCode(65+p)+(h+1);g.push({style:function(t){return t.cellIndex=b,a(e,t,h,p),s(e,b,h,p)},rowIndex:h,columnIndex:String.fromCharCode(65+p),value:_,cellIndex:b,type:x,set:function(t,r){return c(e,h+1,p+1,t,r),this.value=e.values[h]&&e.values[h][p]?e.values[h][p].value:null,this.type=e.values[h]&&e.values[h][p]?e.values[h][p].type:null,s(e,b,h,p)}})}return{style:function(s){return s.cellIndices=t,u(e,s,r),i(e,t,r,n,l,o,f)},cellIndices:t,cells:g,set:function(s,a){var u=[];if(!(s&&s.length&&f&&o))return i(e,t,r,n,l,o,f);if(d||v)for(var c=0;c<this.cells.length&&c<s.length;c++)u.push(s[c]);if(d)s=[u];else if(v)s=u;else{for(var u=[],c=0;c<s.length&&c<o;c++){var y=[];if(s[c].length>f){for(var g=0;g<s[c].length&&g<f;g++)y.push(s[c][g]);s[c]=y}u.push(s[c])}s=u}m(e,n,l,o,f,s,a,!1,d,v);var h=i(e,t,r,n,l,o,f);return this.cells=h.cells,h}}},a=function(e,t,r,n){var l=e._workBook.createStyles(),o=l.addStyles(t).index;e.values[r]||(e.values[r]=[]),e.values[r][n]||(e.values[r][n]={value:"",type:"string"}),e.values[r][n].styleIndex=o},u=function(e,t,r){for(var n=e._workBook.createStyles(),l=n.addStyles(t).index,o=0;o<r.length;o++)e.values[r[o].rowIndex]||(e.values[r[o].rowIndex]=[]),e.values[r[o].rowIndex][r[o].columnIndex]||(e.values[r[o].rowIndex][r[o].columnIndex]={type:"string",value:""}),e.values[r[o].rowIndex][r[o].columnIndex].styleIndex=l},f=function(e,t,r,n,l){var o,s=[],a=[];if(r&&t&&n){var u;if("object"==typeof t&&!t.length){if("formula"!==t.type)return;u=t.value,t=t.formula}var f=r.match(/\D+/)[0],d=r.match(/\d+/)[0];if(e._sharedFormula){o=e._sharedFormula[e._sharedFormula.length-1].si+1}else e._sharedFormula=[],o=0;e._sharedFormula.push({si:o,fromCell:r,toCell:n,formula:t});var c=f.toUpperCase().charCodeAt()-65,m=parseInt(d,10);e.values[m-1]||(e.values[m-1]=[]),e.values[m-1][c]={type:"sharedFormula",si:o,formula:t,range:r+":"+n,value:u},s.push(String.fromCharCode(65+c)+m),a.push({rowIndex:m-1,columnIndex:c});var v,y;if(n&&(v=n.match(/\D+/)[0],y=n.match(/\d+/)[0]),y===d){var g=v.toUpperCase().charCodeAt()-65;for(c++;c<=g;c++)e.values[m-1][c]={type:"sharedFormula",si:o,value:u},s.push(String.fromCharCode(65+c)+m),a.push({rowIndex:m-1,columnIndex:c})}else if(v===f){var h=parseInt(y,10);for(m++;m<=h;m++)e.values[m-1]||(e.values[m-1]=[]),s.push(String.fromCharCode(65+c)+m),a.push({rowIndex:m-1,columnIndex:c}),e.values[m-1][c]={type:"sharedFormula",si:o,value:u}}if(l){l.cellIndices=s;var p;p=e._workBook.createStyles().addStyles(l);for(var _=0;_<a.length;_++)e.values[a[_].rowIndex][a[_].columnIndex].styleIndex=p.index}return i(e,s,a)}},d=function(e){delete e.sheetName,delete e.sheetId,delete e.rId,delete e.values,delete e._workBook,delete e._sharedFormula},c=function(e,t,r,n,l){if(t&&r&&"number"==typeof t&&"number"==typeof r){if(l||void 0!==n&&null!==n)return l||"object"!=typeof n||n.type||void 0!==n.value&&null!==n.value?void 0===n||null===n?v(e,t,r,l):o(n,e,t,r,l):v(e,t,r,n);var i=String.fromCharCode(65+r-1)+t;return s(e,i,t-1,r-1)}},m=function(e,t,r,n,o,s,a,f,d,c){if(t&&r&&"number"==typeof t&&"number"==typeof r&&"number"==typeof n&&"number"==typeof o){for(var m=[],v=[],y=n,g=t-1;y>0;g++,y--){var h=o;e.values[g]||(e.values[g]=[]);for(var p=r-1;h>0;p++,h--)v.push(String.fromCharCode(65+p)+(g+1)),m.push({rowIndex:g,columnIndex:p})}if(a||s){if(a||!s||s.length){if(void 0===s||null===s){if(a.cellIndices=v,u(e,a,m),!f)return;return i(e,v,m,t,r,n,o,d,c)}if(l(s,e,t,r,a,v),!f)return;return i(e,v,m,t,r,n,o,d,c)}if(s.cellIndices=v,u(e,s,m),!f)return;return i(e,v,m,t,r,n,o,d,c)}return i(e,v,m,t,r,n,o,d,c)}},v=function(e,t,r,n){var l=String.fromCharCode(65+r-1)+t;return n.cellIndex=l,a(e,n,t-1,r-1),s(e,l,t-1,r-1)};return{createSheet:function(e,n,l,o){var s={sheetName:e,sheetId:n,rId:l,values:[],_workBook:o};return{_sheet:s,generateContent:function(){t(s)},attach:function(e){r(s,e)},sharedFormula:function(e,t,r,n){return f(s,r,e,t,n)},cell:function(e,t,r,n){return c(s,e,t,r,n)},row:function(e,t,r,n){var l=s.values[e-1]?s.values[e-1].length-t+1:0;return m(s,e,t,1,r?r.length:l,r?[r]:null,n,!0,!0,!1)},column:function(e,t,r,n){var l=0;return r&&r.length||(l=s.values&&s.values.length&&s.values.length>e?s.values.length-e+1:0),m(s,e,t,r?r.length:l,1,r,n,!0,!1,!0)},grid:function(e,t,r,n){var l,o=0,i=0;if(r&&r.length)for(o=r.length,l=0;l<r.length;l++)r[l]&&r[l].length&&(i=i<r[l].length?r[l].length:i);else if(s.values&&s.values.length){o=s.values.length-e+1;for(var l=0;l<s.values.length;l++)s.values[l]&&s.values[l].length&&(i=i<s.values[l].length-t+1?s.values[l].length-t+1:i)}return m(s,e,t,o,i,r,n,!0,!1)},destroy:function(){return d(s)}}}}}),r("utils",[],function(){return sortObject=function(e){if("object"!=typeof e||e.length)return e;var t={},r=[];for(var n in e)r.push(n);r.sort();for(var l in r)t[r[l]]=sortObject(e[r[l]]);return t},{stringify:function(e){return JSON.stringify(sortObject(e))}}}),r("oxml_xlsx_font",["utils"],function(e){var t=function(e){var t,r="";r+='<fonts count="'+e._fontsCount+'">';for(t in e._fonts){var n=JSON.parse(t);r+="<font>",r+=n.strike?"<strike/>":"",r+=n.italic?"<i/>":"",r+=n.bold?"<b/>":"",r+=n.underline?"<u/>":"",r+=n.size?'<sz val="'+n.size+'"/>':"",r+=n.color?'<color rgb="'+n.color+'"/>':"",r+=n.name?'<name val="'+n.name+'"/>':"",r+=n.family?'<family val="'+n.family+'"/>':"",r+=n.scheme?'<scheme val="'+n.scheme+'"/>':"",r+="</font>"}return r+="</fonts>"},r=function(e){var t={};return t.bold=!!e.bold,t.italic=!!e.italic,t.underline=!!e.underline,t.size=e.fontSize||!1,t.color=e.fontColor||!1,t.name=e.fontName||!1,t.family=e.fontFamily||!1,t.scheme=e.scheme||!1,t.strike=!!e.strike,t},n=function(t,r){return r._fonts[e.stringify(t)]},l=function(e,t){for(var r,n=0,l=0,o=0;o<t.length;o++)for(var s=t[0];n<e.styles.length;n++)if((void 0!==e.styles[n].cellIndices[s]||null!==e.styles[n].cellIndices[s])&&(r=e.styles[n],l++,Object.keys(r.cellIndices).length!==t.length||l>1||0===r._font))return!1;return!!r&&r._font},o=function(t,r){r._fonts||(r._fonts={},r._fontsCount=0);var n=r._fontsCount++;return r._fonts[e.stringify(t)]=""+n,r._fonts[e.stringify(t)]},s=function(t,r,n){return i(t,r,n,!0),n._fonts[e.stringify(t)]=r,r},i=function(t,r,n,l){var o;for(var s in n._fonts)if(n._fonts[s]===r){o=JSON.parse(s);break}l&&delete n._fonts[e.stringify(o)];for(var s in t)t[s]&&(o[s]=t[s]),t[s]=o[s];return t},a=function(e,t){var r,n=0;for(r=0;r<t.styles.length;r++)if(t.styles[r]._font===e&&(n+=Object.keys(t.styles[r].cellIndices).length)>1)return n;return n},u=function(e,t){var i,a=!1,u=r(t),f=e._fonts?n(u,e):null;return void 0!==f&&null!==f?i=f:a=!0,i||!1!==(f=l(e,t.cellIndices))&&(i=s(u,f,e)),void 0!==i&&null!==i||(i=o(u,e)),{font:u,fontIndex:i,newStyleCreated:a}};return{getFontForCell:function(e,t,l){var u,f=!1,d=r(t),c=e._fonts?n(d,e):null;if(void 0!==c&&null!==c?u=c:f=!0,l&&l._font){a(l._font,e)<=1?u=s(d,l._font,e):(d=i(d,l._font,e),c=n(d,e),void 0!==c&&null!==c?u=c:(u=null,f=!0))}return void 0!==u&&null!==u||(u=o(d,e)),{font:d,fontIndex:u,newStyleCreated:f}},getFontForCells:u,generateContent:t}}),r("oxml_xlsx_num_format",["utils"],function(e){var t=function(e){var t="";if(e._numFormats){t+='<numFmts count="'+Object.keys(e._numFormats).length+'">';var r;for(r in e._numFormats){var n=JSON.parse(r);t+='<numFmt numFmtId="'+e._numFormats[r]+'" formatCode="'+n.formatString+'"/>'}t+="</numFmts>"}return t},r=function(e){var t={};return t.formatString=e.numberFormat,t},n=function(t,r){return r._numFormats[e.stringify(t)]},l=function(t,r){r._numFormats||(r._numFormats={},r._numFormatsCount=200);var n=r._numFormatsCount++;return r._numFormats[e.stringify(t)]=""+n,r._numFormats[e.stringify(t)]},o=function(t,r,n){var l;for(var o in n._numFormats)if(n._numFormats[o]===r){l=JSON.parse(o);break}return t.formatString?(delete n._numFormats[e.stringify(l)],n._numFormats[e.stringify(t)]=r):t.formatString=l.formatString,r},s=function(e,t){var r,n=0;for(r=0;r<t.styles.length;r++)if(t.styles[r]._numFormat===e&&(n+=Object.keys(t.styles[r].cellIndices).length)>1)return n;return n},i=function(e,t){for(var r,n=0,l=0,o=0;o<t.length;o++)for(var s=t[0];n<e.styles.length;n++)if((void 0!==e.styles[n].cellIndices[s]||null!==e.styles[n].cellIndices[s])&&(r=e.styles[n],l++,Object.keys(r.cellIndices).length!==t.length||l>1))return!1;return!!r&&r._numFormat},a=function(e,t){var s,a=!1,u=r(t),f=e._numFormats?n(u,e):null;return void 0!==f&&null!==f?s=f:u.formatString&&(a=!0),s||!1!==(f=i(e,t.cellIndices))&&(s=o(u,f,e)),void 0!==s&&null!==s||!u.formatString||(s=l(u,e)),{numFormat:u,numFormatIndex:s||!1,newStyleCreated:a}};return{generateContent:t,getNumFormatForCell:function(e,t,i){var a,u=!1,f=r(t),d=e._numFormats?n(f,e):null;if(void 0!==d&&null!==d?a=d:f.formatString&&(u=!0),i&&i._numFormat){s(i._numFormat,e)<=1&&e._numFormats&&(a=o(f,i._numFormat,e))}return void 0!==a&&null!==a||!f.formatString||(a=l(f,e)),{numFormat:f,numFormatIndex:a||!1,newStyleCreated:u}},getNumFormatForCells:a}}),r("oxml_xlsx_border",["utils"],function(e){var t=function(e,t){if(e.style||e.color){return"<"+t+" "+(e.style?' style="'+e.style+'" ':"")+">"+(e.color?'<color rgb="'+e.color+'"/>':"")+"</"+t+">"}return"<"+t+"/>"},r=function(e){var r,n="";n+='<borders count="'+e._bordersCount+'">';for(r in e._borders){var l=JSON.parse(r);l?(n+="<border>",n+=t(l.left,"left"),n+=t(l.right,"right"),n+=t(l.top,"top"),n+=t(l.bottom,"bottom"),n+=t(l.diagonal,"diagonal"),n+="</border>"):n+="<border />"}return n+="</borders>"},n=function(e){var t={};return!!e.border&&(t.left={color:!!e.border.left&&e.border.left.color||e.border.color||!1,style:!!e.border.left&&e.border.left.style||e.border.style||!1},t.top={color:!!e.border.top&&e.border.top.color||e.border.color||!1,style:!!e.border.top&&e.border.top.style||e.border.style||!1},t.bottom={color:!!e.border.bottom&&e.border.bottom.color||e.border.color||!1,style:!!e.border.bottom&&e.border.bottom.style||e.border.style||!1},t.right={color:!!e.border.right&&e.border.right.color||e.border.color||!1,style:!!e.border.right&&e.border.right.style||e.border.style||!1},t.diagonal={color:!!e.border.diagonal&&e.border.diagonal.color||e.border.color||!1,style:!!e.border.diagonal&&e.border.diagonal.style||e.border.style||!1},t.isValid=t.left.style||t.top.style||t.bottom.style||t.right.style||t.diagonal.style||t.left.color||t.top.color||t.bottom.color||t.right.color||t.diagonal.color,!!t.isValid&&t)},l=function(t,r){return r._borders[e.stringify(t)]},o=function(t,r){r._borders||(r._borders={},r._bordersCount=0);var n=r._bordersCount++;return r._borders[e.stringify(t)]=""+n,r._borders[e.stringify(t)]},s=function(e,t){for(var r,n=0,l=0,o=0;o<t.length;o++)for(var s=t[0];n<e.styles.length;n++)if((void 0!==e.styles[n].cellIndices[s]||null!==e.styles[n].cellIndices[s])&&(r=e.styles[n],l++,Object.keys(r.cellIndices).length!==t.length||l>1||0===r._border))return!1;return!!r&&r._border},i=function(t,r,n){return a(t,r,n,!0),n._borders[e.stringify(t)]=r,r},a=function(t,r,n,l){var o;for(var s in n._borders)if(n._borders[s]===r){o=JSON.parse(s);break}if(l&&delete n._borders[e.stringify(o)],t)for(var s in t)(t[s].color||t[s].style)&&(o[s]=t[s]),t[s]=o[s];else t=o;return t},u=function(e,t){var r,n=0;for(r=0;r<t.styles.length;r++)if(t.styles[r]._border===e&&(n+=Object.keys(t.styles[r].cellIndices).length)>1)return n;return n};return{getBorderForCell:function(e,t,r){var s,f=!1,d=n(t),c=e._borders?l(d,e):null;if(void 0!==c&&null!==c?s=c:f=!0,r&&r._border&&r._border!==c){u(r._border,e)<=1&&(s=i(d,r._border,e))}return void 0!==s&&null!==s||(r&&r._border&&(d=a(d,r._border,e,!1)),s=o(d,e)),{border:d,borderIndex:s,newStyleCreated:f}},getBorderForCells:function(e,t){var r,a=!1,u=n(t),f=e._borders?l(u,e):null;return void 0!==f&&null!==f?r=f:a=!0,f=s(e,t.cellIndices),!1!==f&&(r=i(u,f,e)),void 0!==r&&null!==r||(r=o(u,e)),{border:u,borderIndex:r,newStyleCreated:a}},generateContent:r}}),r("oxml_xlsx_fill",["utils"],function(e){var t=function(e){var t,n="";n+='<fills count="'+e._fillsCount+'">';for(t in e._fills){var l=JSON.parse(t);n+=l?r(l):"<fill/>"}return n+="</fills>"},r=function(e){var t="<fill>";if(e.pattern){var r=e.pattern||"none",n=e.fgColor?'<fgColor rgb="'+e.fgColor+'"/>':"";n+=e.bgColor?'<bgColor rgb="'+e.bgColor+'"/>':"",t+='<patternFill patternType="'+r+'">'+n+"</patternFill>"}else{if(!e.gradient)return"<fill/>";t+="<gradientFill "+(e.gradient.type?' type="'+e.gradient.type+'" ':"")+(e.gradient.left?' left="'+e.gradient.left+'" ':"")+(e.gradient.right?' right="'+e.gradient.right+'"':"")+(e.gradient.top?' top="'+e.gradient.top+'" ':"")+(e.gradient.bottom?' bottom="'+e.gradient.bottom+'" ':"")+(e.gradient.degree?' degree="'+e.gradient.degree+'" ':"")+" >";for(var l=0;l<e.gradient.stops.length;l++)t+='<stop position="'+e.gradient.stops[l].position+'">',t+='<color rgb="'+e.gradient.stops[l].color+'" /></stop>';t+="</gradientFill>"}return t+"</fill>"},n=function(e){if(e.fill&&e.fill.pattern){var t={};return t.pattern=e.fill.pattern,t.fgColor=e.fill.foreColor||!1,t.bgColor=e.fill.backColor||e.fill.color||!1,t}if(e.fill&&e.fill.gradient&&e.fill.gradient.stops){var t={};t.gradient={},t.gradient.degree=e.fill.gradient.degree||!1,t.gradient.bottom=e.fill.gradient.bottom||!1,t.gradient.left=e.fill.gradient.left||!1,t.gradient.right=e.fill.gradient.right||!1,t.gradient.top=e.fill.gradient.top||!1,t.gradient.type=e.fill.gradient.type||!1,t.gradient.stops=[];for(var r=0;r<e.fill.gradient.stops.length;r++){var n={};n.position=e.fill.gradient.stops[r].position||0,n.color=e.fill.gradient.stops[r].color||!1,t.gradient.stops.push(n)}return t}return!1},l=function(t,r){return r._fills[e.stringify(t)]},o=function(t,r){r._fills||(r._fills={},r._fillsCount=0);var n=r._fillsCount++;return r._fills[e.stringify(t)]=""+n,r._fills[e.stringify(t)]},s=function(e,t){for(var r,n=0,l=0,o=0;o<t.length;o++)for(var s=t[0];n<e.styles.length;n++)if((void 0!==e.styles[n].cellIndices[s]||null!==e.styles[n].cellIndices[s])&&(r=e.styles[n],l++,Object.keys(r.cellIndices).length!==t.length||l>1||0===r._fill))return!1;return!!r&&r._fill},i=function(t,r,n){return a(t,r,n,!0),n._fills[e.stringify(t)]=r,r},a=function(t,r,n,l){var o;for(var s in n._fills)if(n._fills[s]===r){o=JSON.parse(s);break}l&&delete n._fills[e.stringify(o)];for(var s in t)t[s]&&(o[s]=t[s]),t[s]=o[s];return t},u=function(e,t){var r,a=!1,u=n(t),f=e._fills?l(u,e):null;return void 0!==f&&null!==f?r=f:a=!0,r||!1!==(f=s(e,t.cellIndices))&&(r=i(u,f,e)),void 0!==r&&null!==r||(r=o(u,e)),{fill:u,fillIndex:r,newStyleCreated:a}},f=function(e,t){var r,n=0;for(r=0;r<t.styles.length;r++)if(t.styles[r]._fill===e&&(n+=Object.keys(t.styles[r].cellIndices).length)>1)return n;return n};return{generateContent:t,getFillForCell:function(e,t,r){var s,u=!1,d=n(t),c=e._fills?l(d,e):null;if(void 0!==c&&null!==c?s=c:u=!0,r&&r._fill){f(r._fill,e)<=1&&(s=i(d,r._fill,e))}return void 0!==s&&null!==s||(r&&r._fill&&(d=a(d,r._fill,e,!1)),s=o(d,e)),!s&&r&&r._fill&&(s=r._fill),{fill:d,fillIndex:s,newStyleCreated:u}},getFillForCells:u}}),r("oxml_xlsx_styles",["utils","oxml_xlsx_font","oxml_xlsx_num_format","oxml_xlsx_border","oxml_xlsx_fill"],function(e,t,r,n,l){var o=function(e){var o='<?xml version="1.0" encoding="utf-8" standalone="yes"?><styleSheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main">',s=0;for(o+=r.generateContent(e),o+=t.generateContent(e),o+=l.generateContent(e),o+=n.generateContent(e),o+='<cellStyleXfs count="1"><xf /></cellStyleXfs>',o+='<cellXfs count="'+(parseInt(e.styles.length,10)+1)+'"><xf />',s=0;s<e.styles.length;s++){var i=e.styles[s]._numFormat?' numFmtId="'+e.styles[s]._numFormat+'" ':"",a=e.styles[s]._border?' borderId="'+e.styles[s]._border+'" ':"",u=e.styles[s]._fill?' fillId="'+e.styles[s]._fill+'" ':"";o+='<xf fontId="'+e.styles[s]._font+'" '+i+a+u+" />"}return o+="</cellXfs></styleSheet>"},s=function(e,t){var r=o(t);e.addFile(r,t.fileName,"workbook")},i=function(e,t,r){var n=e.getLastSheet(),l=parseInt((n.Id||"rId0").replace("rId",""),10)+1;return r.addContentType("Override","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",{PartName:"/workbook/style"+l+".xml"}),t.addRelation("rId"+l,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles","style"+l+".xml"),l},a=function(e,t){for(var r=0;r<e.styles.length;r++)if(void 0!==e.styles[r].cellIndices[t]&&null!==e.styles[r].cellIndices[t])return e.styles[r];return null},u=function(e,t){for(var r=0;r<e.styles.length;r++)if(e.styles[r]._font===t._font&&e.styles[r]._numFormat===t._numFormat)return e.styles[r];return null},f=function(e,o){if(e.cellIndex||e.cellIndices){var s,i,f,d,c,m=!1;if(e.cellIndex){if(s=a(o,e.cellIndex),i=t.getFontForCell(o,e,s),f=r.getNumFormatForCell(o,e,s),d=n.getBorderForCell(o,e,s),c=l.getFillForCell(o,e,s),m=m||i.newStyleCreated||d.newStyleCreated||c.newStyleCreated,s){if(s._font===i.fontIndex&&s._numFormat===f.numFormatIndex&&s._border===d.borderIndex&&s._fill===c.fillIndex)return s;if(1===Object.keys(s.cellIndices).length)return s._font=i.fontIndex,s._numFormat=f.numFormatIndex,s._border=d.borderIndex,s._fill=c.fillIndex,s;delete s.cellIndices[e.cellIndex]}return!m&&(s=u(o,{_font:i.fontIndex,_numFormat:f.numFormatIndex,_border:d.borderIndex,_fill:c.fillIndex}))?(s.cellIndices[e.cellIndex]=Object.keys(s.cellIndices).length,s):(s={_font:i.fontIndex,_numFormat:f.numFormatIndex||!1,_border:d.borderIndex,_fill:c.fillIndex,cellIndices:{}},s.cellIndices[e.cellIndex]=0,s.index=""+(parseInt(o.styles.length,10)+1),o.styles.push(s),s)}if(e.cellIndices){var v;if(i=t.getFontForCells(o,e),f=r.getNumFormatForCells(o,e),d=n.getBorderForCells(o,e),c=l.getFillForCells(o,e),!(m=m||i.newStyleCreated||f.newStyleCreated||d.newStyleCreated||c.newStyleCreated)&&(s=u(o,{_font:i.fontIndex,_numFormat:f.numFormatIndex,_border:d.borderIndex,_fill:c.fillIndex}))){for(v=0;v<e.cellIndices.length;v++){var y=e.cellIndices[v],g=a(o,y);delete g.cellIndices[y],s.cellIndices[y]=Object.keys(s.cellIndices).length}return s}for(s={_font:i.fontIndex,_numFormat:f.numFormatIndex,_border:d.borderIndex,_fill:c.fillIndex,cellIndices:{}},v=0;v<e.cellIndices.length;v++){var y=e.cellIndices[v],g=a(o,y);if(g&&delete g.cellIndices[y],s.cellIndices[y]=Object.keys(s.cellIndices).length,g&&!Object.keys(g.cellIndices).length){for(key in s)g[key]=s[key];return g}}return s.index=""+(parseInt(o.styles.length,10)+1),o.styles.push(s),s}}};return{createStyle:function(t,r,n){var l=i(t,r,n),a={sheetId:l,fileName:"style"+l+".xml",styles:[],_fonts:{},_borders:{},_fills:{},_fontsCount:1,_bordersCount:1,_fillsCount:2},u={bold:!1,italic:!1,underline:!1,size:!1,color:!1,strike:!1,family:!1,name:!1,scheme:!1};a._fonts[e.stringify(u)]=0,a._borders[!1]=0,a._fills[!1]=0;var d={pattern:"gray125",fgColor:!1,bgColor:!1};return a._fills[e.stringify(d)]=1,{_styles:a,generateContent:function(){return o(a)},attach:function(e){s(e,a)},addStyles:function(e){return f(e,a)}}}}}),r("oxml_workbook",["oxml_content_types","oxml_rels","oxml_sheet","oxml_xlsx_styles"],function(e,t,r,n){"use strict";var l=function(e){return e._rels.relations.length?e._rels.relations[e._rels.relations.length-1]:{}},o=function(e,t){var r,n='<workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"><sheets>';for(r=0;r<e.sheets.length;r++)n+='<sheet name="'+e.sheets[r]._sheet.sheetName+'" sheetId="'+e.sheets[r]._sheet.sheetId+'" r:id="'+e.sheets[r]._sheet.rId+'" />',t&&e.sheets[r].attach(t);return n+="</sheets></workbook>"},s=function(e){if(e._sharedStrings&&Object.keys(e._sharedStrings).length){var t='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><sst xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main">';for(var r in e._sharedStrings)t+="<si><t>"+r+"</t></si>";return t+="</sst>"}return""},i=function(e,t){var n=l(e),o=parseInt((n.Id||"rId0").replace("rId",""),10)+1;t=t||"sheet"+o,e._rels.addRelation("rId"+o,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","sheets/sheet"+o+".xml");var s=r.createSheet(t,o,"rId"+o,e);return e.sheets.push(s),e.xlsxContentTypes.addContentType("Override","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",{PartName:"/workbook/sheets/sheet"+o+".xml"}),s},a=function(e,t){t._rels.attach(e);var r=o(t,e);e.addFile(r,"workbook.xml","workbook");var n=s(t);n&&e.addFile(n,"sharedstrings.xml","workbook"),t._styles&&t._styles.attach(e)},u=function(e,t){if(e){if(!t._sharedStrings){t._sharedStrings={},t.xlsxContentTypes.addContentType("Override","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",{PartName:"/workbook/sharedstrings.xml"});var r=l(t),n=parseInt((r.Id||"rId0").replace("rId",""),10)+1;t._rels.addRelation("rId"+n,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings","sharedstrings.xml")}return isNaN(t._sharedStrings[e])&&(t._sharedStrings[e]=Object.keys(t._sharedStrings).length||0),t._sharedStrings[e]}},f=function(e,t){return t._sharedStrings[e]},d=function(e){var t;for(delete e.xlsxContentTypes,delete e.xlsxRels,e._rels.destroy(),e._rels.destroy=null,delete e._rels.destroy,e._rels=null,delete e._rels,e.generateContent=null,delete e.generateContent,e.attach=null,delete e.attach,e.addSheet=null,delete e.addSheet,e.createSharedString=null,delete e.createSharedString,e.getSharedString=null,delete e.getSharedString,e._sharedStrings=null,delete e._sharedStrings,t=0;t<e.sheets.length;t++)e.sheets[t].destroy(),e.sheets[t].destroy=null,delete e.sheets[t].destroy,e.sheets[t]=null;e.sheets=null,delete e.sheets};return{createWorkbook:function(e,r){var s={sheets:[],xlsxContentTypes:e,xlsxRels:r};return s._rels=t.createRelation("workbook.xml.rels","workbook/_rels"),s.addSheet=function(e){return i(s,e)},s.generateContent=function(){return o(s)},s.attach=function(e){a(e,s)},s.createSharedString=function(e){return u(e,s)},s.getSharedString=function(e){return f(e,s)},s.destroy=function(){d(s)},s.createStyles=function(){return s._styles||(s._styles=n.createStyle(s,s._rels,e)),s._styles},s.getLastSheet=function(){return l(s)},s}}}),r("oxml_xlsx",["fileHandler","oxml_content_types","oxml_rels","oxml_workbook"],function(e,t,r,n){"use strict";var l={},o=function(t,r,n){try{var l=e.createFile();return n.contentTypes.attach(l),n._rels.attach(l),n.workBook.attach(l),l.saveFile(t,r)}catch(e){if(r)r("Err: Not able to create Workbook.");else if("undefined"!=typeof Promise)return new Promise(function(e,t){t("Err: Not able to create Workbook.")})}},s=function(){var e={};e.contentTypes=t.createContentType(),e.contentTypes.addContentType("Default","application/vnd.openxmlformats-package.relationships+xml",{Extension:"rels"}),e.contentTypes.addContentType("Default","application/xml",{Extension:"xml"}),
e.contentTypes.addContentType("Override","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",{PartName:"/workbook/workbook.xml"}),e._rels=r.createRelation(".rels","_rels"),e._rels.addRelation("rId1","http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument","workbook/workbook.xml"),e.workBook=n.createWorkbook(e.contentTypes,e._rels);var l=function(t,r){if("undefined"==typeof JSZip)if(r)r("Err: JSZip reference not found.");else if("undefined"!=typeof Promise)return new Promise(function(e,t){t("Err: JSZip reference not found.")});return o(t,r,e)},s=function(){e.workBook.destroy(),delete e.workBook,e._rels.destroy(),delete e._rels,e.contentTypes.destroy(),delete e.contentTypes,e=null};return{_xlsx:e,sheet:e.workBook.addSheet,download:l,destroy:s}};return l.xlsx=s,window.oxml||(window.oxml=l),l}),t("oxml_xlsx")}()}(this);