!function(e,t){e.oxml=function(){var e,t,n;return function(r){function l(e,t){return _.call(e,t)}function o(e,t){var n,r,l,o,s,i,a,u,f,d,c,m=t&&t.split("/"),v=h.map,g=v&&v["*"]||{};if(e){for(s=(e=e.split("/")).length-1,h.nodeIdCompat&&b.test(e[s])&&(e[s]=e[s].replace(b,"")),"."===e[0].charAt(0)&&m&&(e=m.slice(0,m.length-1).concat(e)),f=0;f<e.length;f++)if("."===(c=e[f]))e.splice(f,1),f-=1;else if(".."===c){if(0===f||1===f&&".."===e[2]||".."===e[f-1])continue;f>0&&(e.splice(f-1,2),f-=2)}e=e.join("/")}if((m||g)&&v){for(f=(n=e.split("/")).length;f>0;f-=1){if(r=n.slice(0,f).join("/"),m)for(d=m.length;d>0;d-=1)if((l=v[m.slice(0,d).join("/")])&&(l=l[r])){o=l,i=f;break}if(o)break;!a&&g&&g[r]&&(a=g[r],u=f)}!o&&a&&(o=a,i=u),o&&(n.splice(0,i,o),e=n.join("/"))}return e}function s(e,t){return function(){var n=x.call(arguments,0);return"string"!=typeof n[0]&&1===n.length&&n.push(null),c.apply(r,n.concat([e,t]))}}function i(e){return function(t){g[e]=t}}function a(e){if(l(y,e)){var t=y[e];delete y[e],p[e]=!0,d.apply(r,t)}if(!l(g,e)&&!l(p,e))throw new Error("No "+e);return g[e]}function u(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function f(e){return e?u(e):[]}var d,c,m,v,g={},y={},h={},p={},_=Object.prototype.hasOwnProperty,x=[].slice,b=/\.js$/;m=function(e,t){var n,r=u(e),l=r[0],s=t[1];return e=r[1],l&&(n=a(l=o(l,s))),l?e=n&&n.normalize?n.normalize(e,function(e){return function(t){return o(t,e)}}(s)):o(e,s):(l=(r=u(e=o(e,s)))[0],e=r[1],l&&(n=a(l))),{f:l?l+"!"+e:e,n:e,pr:l,p:n}},v={require:function(e){return s(e)},exports:function(e){var t=g[e];return void 0!==t?t:g[e]={}},module:function(e){return{id:e,uri:"",exports:g[e],config:function(e){return function(){return h&&h.config&&h.config[e]||{}}}(e)}}},d=function(e,t,n,o){var u,d,c,h,_,x,b,I=[],C=typeof n;if(o=o||e,x=f(o),"undefined"===C||"function"===C){for(t=!t.length&&n.length?["require","exports","module"]:t,_=0;_<t.length;_+=1)if(h=m(t[_],x),"require"===(d=h.f))I[_]=v.require(e);else if("exports"===d)I[_]=v.exports(e),b=!0;else if("module"===d)u=I[_]=v.module(e);else if(l(g,d)||l(y,d)||l(p,d))I[_]=a(d);else{if(!h.p)throw new Error(e+" missing "+d);h.p.load(h.n,s(o,!0),i(d),{}),I[_]=g[d]}c=n?n.apply(g[e],I):void 0,e&&(u&&u.exports!==r&&u.exports!==g[e]?g[e]=u.exports:c===r&&b||(g[e]=c))}else e&&(g[e]=n)},e=t=c=function(e,t,n,l,o){if("string"==typeof e)return v[e]?v[e](t):a(m(e,f(t)).f);if(!e.splice){if((h=e).deps&&c(h.deps,h.callback),!t)return;t.splice?(e=t,t=n,n=null):e=r}return t=t||function(){},"function"==typeof n&&(n=l,l=o),l?d(r,e,t,n):setTimeout(function(){d(r,e,t,n)},4),c},c.config=function(e){return c(e)},e._defined=g,(n=function(e,t,n){if("string"!=typeof e)throw new Error("See almond README: incorrect module build, no module name");t.splice||(n=t,t=[]),l(g,e)||l(y,e)||(y[e]=[e,t,n])}).amd={jQuery:!0}}(),n("build/almond",function(){}),n("fileHandler",[],function(){"use strict";return{createFile:function(){if(window.JSZip){var e=new JSZip,t={_zip:e};return t.addFile=function(t,n,r){var l;r&&(l=e.folder(r)),(l||e).file(n,t)},t.saveFile=function(t,n){return e.generateAsync({type:"blob"}).then(function(e){try{if(window.saveAs)return saveAs(e,t);var r=window.URL.createObjectURL(e),l=document.createElement("a");if(l.setAttribute("href",r),l.setAttribute("download",t),l.style.display="none",document.body.appendChild(l),l.click(),document.body.removeChild(l),n)n();else if("undefined"!=typeof Promise)return new Promise(function(e,t){e()})}catch(e){if(n)n("Err: Not able to create file object.");else if("undefined"!=typeof Promise)return new Promise(function(e,t){t("Err: Not able to create file object.")})}})},t}}}}),n("oxml_rels",[],function(){"use strict";var e=function(e,t,n,r){r.relations.push({Id:e,Type:t,Target:n})},t=function(e){var t,n='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">';for(t=0;t<e.relations.length;t++){var r=e.relations[t];n+='<Relationship Id="'+r.Id+'" Type="'+r.Type+'" Target="'+r.Target+'"/>'}return n+="</Relationships>"},n=function(e,n){var r=t(n);e.addFile(r,n.fileName,n.folderName)},r=function(e){e.relations=null,delete e.relations,e.addRelation=null,delete e.addRelation,e.generateContent=null,delete e.generateContent,e.attach=null,delete e.attach};return{createRelation:function(l,o){var s={relations:[],fileName:l,folderName:o};return s.addRelation=function(t,n,r){e(t,n,r,s)},s.generateContent=function(){return t(s)},s.attach=function(e){return n(e,s)},s.destroy=function(){r(s)},s}}}),n("oxml_content_types",[],function(){"use strict";var e=function(e){var t,n='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types">';for(t=0;t<e.contentTypes.length;t++){var r=e.contentTypes[t];n+="<"+r.name+' ContentType="'+r.contentType+'" ',r.Extension&&(n+='Extension="'+r.Extension+'" '),r.PartName&&(n+='PartName="'+r.PartName+'" '),n+="/>\n"}return n+="</Types>"},t=function(t,n){var r=e(n);t.addFile(r,"[Content_Types].xml")},n=function(e,t,n,r){var l={name:e,contentType:t};for(var o in n)l[o]=n[o];r.contentTypes.push(l)},r=function(e){e.addContentType=null,delete e.addContentType,e.generateContent=null,delete e.generateContent,e.attach=null,delete e.attach,e.contentTypes=null,delete e.contentTypes};return{createContentType:function(){var l={contentTypes:[]};return l.addContentType=function(e,t,r){n(e,t,r,l)},l.generateContent=function(){return e(l)},l.attach=function(e){return t(e,l)},l.destroy=function(){r(l)},l}}}),n("oxml_sheet",[],function(){"use strict";var e=function(e,t){if(!e)return"";var n=e.styleIndex?' s="'+e.styleIndex+'" ':"";if("numeric"===e.type)return'<c r="'+t+'" '+n+"><v>"+e.value+"</v></c>";if("sharedString"===e.type)return'<c r="'+t+'" t="s" '+n+"><v>"+e.value+"</v></c>";if("sharedFormula"===e.type)return e.formula?'<c  r="'+t+'" '+n+'><f t="shared" ref="'+e.range+'" si="'+e.si+'">'+e.formula+"</f></c>":'<c  r="'+t+'" '+n+'><f t="shared" si="'+e.si+'"></f></c>';if("string"===e.type)return'<c r="'+t+'" t="inlineStr" '+n+"><is><t>"+e.value+"</t></is></c>";if("formula"===e.type){var r=null!==e.value&&void 0!==e.value?"<v>"+e.value+"</v>":"";return'<c r="'+t+'" '+n+"><f>"+e.formula+"</f>"+r+"</c>"}},t=function(t){var n=0,r="";if(t.values&&t.values.length)for(n=0;n<t.values.length;n++)if(t.values[n]&&t.values[n].length>0){r+='<row r="'+(n+1)+'">\n';var l=0;for(l=0;l<t.values[n].length;l++){var o=String.fromCharCode(65+l),s=t.values[n][l],i=o+(n+1),a=e(s,i);r+=a}r+="</row>"}return'<worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main"><sheetData>'+r+"</sheetData></worksheet>"},n=function(e,n){var r=t(e);n.addFile(r,"sheet"+e.sheetId+".xml","workbook/sheets")},r=function(e,t){if(void 0===e||null===e)return null;if("object"==typeof e){if(!(void 0!==e.value&&null!==e.value||e.formula&&"formula"===e.type))return null;if(e.type)return"sharedString"===e.type?"number"==typeof e.value?{type:e.type,value:e.value}:(e.value=t._workBook.createSharedString(e.value,t._workBook),{type:e.type,value:e.value}):"formula"===e.type?{type:e.type,formula:e.formula,value:e.value}:"numeric"===e.type||"string"===e.type?{type:e.type,value:e.value}:null;e=e.value}return"number"==typeof e?{type:"numeric",value:e}:"string"==typeof e?{type:"string",value:e}:"boolean"==typeof e?{type:"string",value:e+""}:null},l=function(e,t,n,l,o,s){var i,a;if(o){o.cellIndices=s;a=t._workBook.createStyles().addStyles(o)}for(i=0;i<e.length;i++)if(void 0!==e[i]||null!==e[i]){var u=i+n-1;if(t.values[u]||(t.values[u]=[]),"object"==typeof e[i]&&e[i].length>=0){var f;for(f=0;f<e[i].length;f++){var d=r(e[i][f],t);d&&(a&&(d.styleIndex=a.index),a||!t.values[u][f+l-1]?t.values[u][f+l-1]=d:(t.values[u][f+l-1].value=d.value,t.values[u][f+l-1].type=d.type))}}else{var d=r(e[i],t);d&&(a&&(d.styleIndex=a.index),a||!t.values[u][l-1]?t.values[u][l-1]=d:(t.values[u][l-1].value=d.value,t.values[u][l-1].type=d.type))}}},o=function(e,t,n,l,o){var i=String.fromCharCode(65+l-1)+n,a=n-1;if(void 0!==e&&null!==e){if(t.values[a]||(t.values[a]=[]),e=r(e,t),o){o.cellIndex=i;var u=t._workBook.createStyles();e.styleIndex=u.addStyles(o).index}!e.styleIndex&&t.values[a][l-1]&&(e.styleIndex=t.values[a][l-1].styleIndex),t.values[a][l-1]=e}return s(t,i,a,l-1)},s=function(e,t,n,r){return{style:function(l){return l.cellIndex=t,a(e,l,n,r),s(e,t,n,r)},value:e.values[n]&&e.values[n][r]?e.values[n][r].value:null,type:e.values[n]&&e.values[n][r]?e.values[n][r].type:null,cellIndex:t,rowIndex:n+1,columnIndex:r+1,set:function(l,o){return c(e,n+1,r+1,l,o),this.value=e.values[n]&&e.values[n][r]?e.values[n][r].value:null,this.type=e.values[n]&&e.values[n][r]?e.values[n][r].type:null,s(e,t,n,r)}}},i=function(e,t,n,r,l,o,f,d){var v,g=[];for(v=0;v<n.length;v++){var y=n[v].rowIndex,h=n[v].columnIndex,p=e.values[y]&&e.values[y][h]?e.values[y][h].value:null,_=e.values[y]&&e.values[y][h]?e.values[y][h].type:null,x=String.fromCharCode(65+h)+(y+1);g.push({style:function(t){return t.cellIndex=x,a(e,t,y,h),s(e,x,y,h)},rowIndex:y,columnIndex:h,value:p,cellIndex:x,type:_,set:function(t,n){return c(e,y+1,h+1,t,n),this.value=e.values[y]&&e.values[y][h]?e.values[y][h].value:null,this.type=e.values[y]&&e.values[y][h]?e.values[y][h].type:null,s(e,x,y,h)}})}return{style:function(s){return s.cellIndices=t,u(e,s,n),i(e,t,n,r,l,o,f)},cellIndices:t,cells:g,set:function(t,n){if(t&&t.length){if(d)f=f>t.length?f:t.length,t=[t];else{o=o>t.length?o:t.length;for(var s=0;s<t.length;s++)t[s]&&t[s].length&&(f=f<t[s].length?t[s].length:f)}return m(e,r,l,o,f,t,n,d)}}}},a=function(e,t,n,r){var l=e._workBook.createStyles(),o=l.addStyles(t).index;e.values[n]||(e.values[n]=[]),e.values[n][r]||(e.values[n][r]={value:"",type:"string"}),e.values[n][r].styleIndex=o},u=function(e,t,n){for(var r=e._workBook.createStyles(),l=r.addStyles(t).index,o=0;o<n.length;o++)e.values[n[o].rowIndex]||(e.values[n[o].rowIndex]=[]),e.values[n[o].rowIndex][n[o].columnIndex]||(e.values[n[o].rowIndex][n[o].columnIndex]={type:"string",value:""}),e.values[n[o].rowIndex][n[o].columnIndex].styleIndex=l},f=function(e,t,n,r,l){var o,s=[],a=[];if(n&&t&&r){var u=n.match(/\D+/)[0],f=n.match(/\d+/)[0];if(e._sharedFormula){o=e._sharedFormula[e._sharedFormula.length-1].si+1}else e._sharedFormula=[],o=0;e._sharedFormula.push({si:o,fromCell:n,toCell:r,formula:t});var d=u.toUpperCase().charCodeAt()-65,c=parseInt(f,10);e.values[c-1]||(e.values[c-1]=[]),e.values[c-1][d]={type:"sharedFormula",si:o,formula:t,range:n+":"+r},s.push(String.fromCharCode(65+d)+c),a.push({rowIndex:c-1,columnIndex:d});var m,v;if(r&&(m=r.match(/\D+/)[0],v=r.match(/\d+/)[0]),v===f){var g=m.toUpperCase().charCodeAt()-65;for(d++;d<=g;d++)e.values[c-1][d]={type:"sharedFormula",si:o},s.push(String.fromCharCode(65+d)+c),a.push({rowIndex:c-1,columnIndex:d})}else if(m===u){var y=parseInt(v,10);for(c++;c<=y;c++)e.values[c-1]||(e.values[c-1]=[]),s.push(String.fromCharCode(65+d)+c),a.push({rowIndex:c-1,columnIndex:d}),e.values[c-1][d]={type:"sharedFormula",si:o}}if(l){l.cellIndices=s;var h;h=e._workBook.createStyles().addStyles(l);for(var p=0;p<a.length;p++)e.values[a[p].rowIndex][a[p].columnIndex].styleIndex=h.index}return i(e,s,a)}},d=function(e){delete e.sheetName,delete e.sheetId,delete e.rId,delete e.values,delete e._workBook,delete e._sharedFormula},c=function(e,t,n,r,l){if(t&&n&&"number"==typeof t&&"number"==typeof n){if(l||void 0!==r&&null!==r)return l||"object"!=typeof r||r.type||void 0!==r.value&&null!==r.value?void 0===r||null===r?v(e,t,n,l):o(r,e,t,n,l):v(e,t,n,r);var i=String.fromCharCode(65+n-1)+t;return s(e,i,t-1,n-1)}},m=function(e,t,n,r,o,s,a,f){if(t&&n&&"number"==typeof t&&"number"==typeof n&&"number"==typeof r&&"number"==typeof o){for(var d=[],c=[],m=r,v=t-1;m>0;v++,m--){var g=o;e.values[v]||(e.values[v]=[]);for(var y=n-1;g>0;y++,g--)c.push(String.fromCharCode(65+y)+(v+1)),d.push({rowIndex:v,columnIndex:y})}return a||s?a||!s||s.length?void 0===s||null===s?(a.cellIndices=c,u(e,a,d),i(e,c,d,t,n,r,o,f)):(l(s,e,t,n,a,c),i(e,c,d,t,n,r,o,f)):(s.cellIndices=c,u(e,s,d),i(e,c,d,t,n,r,o,f)):i(e,c,d,t,n,r,o,f)}},v=function(e,t,n,r){var l=String.fromCharCode(65+n-1)+t;return r.cellIndex=l,a(e,r,t-1,n-1),s(e,l,t-1,n-1)};return{createSheet:function(e,r,l,o){var s={sheetName:e,sheetId:r,rId:l,values:[],_workBook:o};return{_sheet:s,generateContent:function(){t(s)},attach:function(e){n(s,e)},updateSharedFormula:function(e,t,n,r){return f(s,e,t,n,r)},cell:function(e,t,n,r){return c(s,e,t,n,r)},row:function(e,t,n,r){var l=s.values[e-1]?s.values[e-1].length:0;return m(s,e,t,1,n?n.length:l,n?[n]:null,r,!0)},column:function(e,t,n,r){var l,o=0;if(!n||!n.length)for(l=0;l<e;l++)s.values[l]&&(o=o<s.values[l].length?s.values[l]:o);return m(s,e,t,n?n.length:o,1,n,r,!1)},grid:function(e,t,n,r){var l,o=0,i=0;if(n&&n.length)for(o=n.length,l=0;l<n.length;l++)n[l]&&n[l].length&&(i=i<n[l].length?n[l].length:i);else if(s.values&&s.values.length){o=s.values.length-e+1;for(var l=0;l<s.values.length;l++)s.values[l]&&s.values[l].length&&(i=i<s.values[l].length?s.values[l].length:i)}return m(s,e,t,o,i,n,r)},destroy:function(){return d(s)}}}}}),n("utils",[],function(){return sortObject=function(e){if("object"!=typeof e||e.length)return e;var t={},n=[];for(var r in e)n.push(r);n.sort();for(var l in n)t[n[l]]=sortObject(e[n[l]]);return t},{stringify:function(e){return JSON.stringify(sortObject(e))}}}),n("oxml_xlsx_font",["utils"],function(e){var t=function(e){var t,n="";n+='<fonts count="'+e._fontsCount+'">';for(t in e._fonts){var r=JSON.parse(t);n+="<font>",n+=r.strike?"<strike/>":"",n+=r.italic?"<i/>":"",n+=r.bold?"<b/>":"",n+=r.underline?"<u/>":"",n+=r.size?'<sz val="'+r.size+'"/>':"",n+=r.color?'<color rgb="'+r.color+'"/>':"",n+=r.name?'<name val="'+r.name+'"/>':"",n+=r.family?'<family val="'+r.family+'"/>':"",n+=r.scheme?'<scheme val="'+r.scheme+'"/>':"",n+="</font>"}return n+="</fonts>"},n=function(e){var t={};return t.bold=!!e.bold,t.italic=!!e.italic,t.underline=!!e.underline,t.size=e.fontSize||!1,t.color=e.fontColor||!1,t.name=e.fontName||!1,t.family=e.fontFamily||!1,t.scheme=e.scheme||!1,t.strike=!!e.strike,t},r=function(t,n){return n._fonts[e.stringify(t)]},l=function(e,t){for(var n,r=0,l=0,o=0;o<t.length;o++)for(var s=t[0];r<e.styles.length;r++)if((void 0!==e.styles[r].cellIndices[s]||null!==e.styles[r].cellIndices[s])&&(n=e.styles[r],l++,Object.keys(n.cellIndices).length!==t.length||l>1||0===n._font))return!1;return!!n&&n._font},o=function(t,n){n._fonts||(n._fonts={},n._fontsCount=0);var r=n._fontsCount++;return n._fonts[e.stringify(t)]=""+r,n._fonts[e.stringify(t)]},s=function(t,n,r){return i(t,n,r,!0),r._fonts[e.stringify(t)]=n,n},i=function(t,n,r,l){var o;for(var s in r._fonts)if(r._fonts[s]===n){o=JSON.parse(s);break}l&&delete r._fonts[e.stringify(o)];for(var s in t)t[s]&&(o[s]=t[s]),t[s]=o[s];return t},a=function(e,t){var n,r=0;for(n=0;n<t.styles.length;n++)if(t.styles[n]._font===e&&(r+=Object.keys(t.styles[n].cellIndices).length)>1)return r;return r},u=function(e,t){var i,a=!1,u=n(t),f=e._fonts?r(u,e):null;return void 0!==f&&null!==f?i=f:a=!0,i||!1!==(f=l(e,t.cellIndices))&&(i=s(u,f,e)),void 0!==i&&null!==i||(i=o(u,e)),{font:u,fontIndex:i,newStyleCreated:a}};return{getFontForCell:function(e,t,l){var u,f=!1,d=n(t),c=e._fonts?r(d,e):null;if(void 0!==c&&null!==c?u=c:f=!0,l&&l._font){a(l._font,e)<=1?u=s(d,l._font,e):(d=i(d,l._font,e),c=r(d,e),void 0!==c&&null!==c?u=c:(u=null,f=!0))}return void 0!==u&&null!==u||(u=o(d,e)),{font:d,fontIndex:u,newStyleCreated:f}},getFontForCells:u,generateContent:t}}),n("oxml_xlsx_num_format",["utils"],function(e){var t=function(e){var t="";if(e._numFormats){t+='<numFmts count="'+Object.keys(e._numFormats).length+'">';var n;for(n in e._numFormats){var r=JSON.parse(n);t+='<numFmt numFmtId="'+e._numFormats[n]+'" formatCode="'+r.formatString+'"/>'}t+="</numFmts>"}return t},n=function(e){var t={};return t.formatString=e.numberFormat,t},r=function(t,n){return n._numFormats[e.stringify(t)]},l=function(t,n){n._numFormats||(n._numFormats={},n._numFormatsCount=200);var r=n._numFormatsCount++;return n._numFormats[e.stringify(t)]=""+r,n._numFormats[e.stringify(t)]},o=function(t,n,r){var l;for(var o in r._numFormats)if(r._numFormats[o]===n){l=JSON.parse(o);break}return t.formatString?(delete r._numFormats[e.stringify(l)],r._numFormats[e.stringify(t)]=n):t.formatString=l.formatString,n},s=function(e,t){var n,r=0;for(n=0;n<t.styles.length;n++)if(t.styles[n]._numFormat===e&&(r+=Object.keys(t.styles[n].cellIndices).length)>1)return r;return r},i=function(e,t){for(var n,r=0,l=0,o=0;o<t.length;o++)for(var s=t[0];r<e.styles.length;r++)if((void 0!==e.styles[r].cellIndices[s]||null!==e.styles[r].cellIndices[s])&&(n=e.styles[r],l++,Object.keys(n.cellIndices).length!==t.length||l>1))return!1;return!!n&&n._numFormat},a=function(e,t){var s,a=!1,u=n(t),f=e._numFormats?r(u,e):null;return void 0!==f&&null!==f?s=f:u.formatString&&(a=!0),s||!1!==(f=i(e,t.cellIndices))&&(s=o(u,f,e)),void 0!==s&&null!==s||!u.formatString||(s=l(u,e)),{numFormat:u,numFormatIndex:s||!1,newStyleCreated:a}};return{generateContent:t,getNumFormatForCell:function(e,t,i){var a,u=!1,f=n(t),d=e._numFormats?r(f,e):null;if(void 0!==d&&null!==d?a=d:f.formatString&&(u=!0),i&&i._numFormat){s(i._numFormat,e)<=1&&e._numFormats&&(a=o(f,i._numFormat,e))}return void 0!==a&&null!==a||!f.formatString||(a=l(f,e)),{numFormat:f,numFormatIndex:a||!1,newStyleCreated:u}},getNumFormatForCells:a}}),n("oxml_xlsx_border",["utils"],function(e){var t=function(e,t){if(e.style||e.color){return"<"+t+" "+(e.style?' style="'+e.style+'" ':"")+">"+(e.color?'<color rgb="'+e.color+'"/>':"")+"</"+t+">"}return"<"+t+"/>"},n=function(e){var n,r="";r+='<borders count="'+e._bordersCount+'">';for(n in e._borders){var l=JSON.parse(n);l?(r+="<border>",r+=t(l.left,"left"),r+=t(l.right,"right"),r+=t(l.top,"top"),r+=t(l.bottom,"bottom"),r+=t(l.diagonal,"diagonal"),r+="</border>"):r+="<border />"}return r+="</borders>"},r=function(e){var t={};return!!e.border&&(t.left={color:!!e.border.left&&e.border.left.color||e.border.color||!1,style:!!e.border.left&&e.border.left.style||e.border.style||!1},t.top={color:!!e.border.top&&e.border.top.color||e.border.color||!1,style:!!e.border.top&&e.border.top.style||e.border.style||!1},t.bottom={color:!!e.border.bottom&&e.border.bottom.color||e.border.color||!1,style:!!e.border.bottom&&e.border.bottom.style||e.border.style||!1},t.right={color:!!e.border.right&&e.border.right.color||e.border.color||!1,style:!!e.border.right&&e.border.right.style||e.border.style||!1},t.diagonal={color:!!e.border.diagonal&&e.border.diagonal.color||e.border.color||!1,style:!!e.border.diagonal&&e.border.diagonal.style||e.border.style||!1},t.isValid=t.left.style||t.top.style||t.bottom.style||t.right.style||t.diagonal.style||t.left.color||t.top.color||t.bottom.color||t.right.color||t.diagonal.color,!!t.isValid&&t)},l=function(t,n){return n._borders[e.stringify(t)]},o=function(t,n){n._borders||(n._borders={},n._bordersCount=0);var r=n._bordersCount++;return n._borders[e.stringify(t)]=""+r,n._borders[e.stringify(t)]},s=function(e,t){for(var n,r=0,l=0,o=0;o<t.length;o++)for(var s=t[0];r<e.styles.length;r++)if((void 0!==e.styles[r].cellIndices[s]||null!==e.styles[r].cellIndices[s])&&(n=e.styles[r],l++,Object.keys(n.cellIndices).length!==t.length||l>1||0===n._border))return!1;return!!n&&n._border},i=function(t,n,r){return a(t,n,r,!0),r._borders[e.stringify(t)]=n,n},a=function(t,n,r,l){var o;for(var s in r._borders)if(r._borders[s]===n){o=JSON.parse(s);break}if(l&&delete r._borders[e.stringify(o)],t)for(var s in t)(t[s].color||t[s].style)&&(o[s]=t[s]),t[s]=o[s];else t=o;return t},u=function(e,t){var n,r=0;for(n=0;n<t.styles.length;n++)if(t.styles[n]._border===e&&(r+=Object.keys(t.styles[n].cellIndices).length)>1)return r;return r};return{getBorderForCell:function(e,t,n){var s,f=!1,d=r(t),c=e._borders?l(d,e):null;if(void 0!==c&&null!==c?s=c:f=!0,n&&n._border&&n._border!==c){u(n._border,e)<=1&&(s=i(d,n._border,e))}return void 0!==s&&null!==s||(n&&n._border&&(d=a(d,n._border,e,!1)),s=o(d,e)),{border:d,borderIndex:s,newStyleCreated:f}},getBorderForCells:function(e,t){var n,a=!1,u=r(t),f=e._borders?l(u,e):null;return void 0!==f&&null!==f?n=f:a=!0,f=s(e,t.cellIndices),!1!==f&&(n=i(u,f,e)),void 0!==n&&null!==n||(n=o(u,e)),{border:u,borderIndex:n,newStyleCreated:a}},generateContent:n}}),n("oxml_xlsx_fill",["utils"],function(e){var t=function(e){var t,r="";r+='<fills count="'+e._fillsCount+'">';for(t in e._fills){var l=JSON.parse(t);r+=l?n(l):"<fill/>"}return r+="</fills>"},n=function(e){var t="<fill>";if(e.pattern){var n=e.pattern||"none",r=e.fgColor?'<fgColor rgb="'+e.fgColor+'"/>':"";r+=e.bgColor?'<bgColor rgb="'+e.bgColor+'"/>':"",t+='<patternFill patternType="'+n+'">'+r+"</patternFill>"}else{if(!e.gradient)return"<fill/>";t+="<gradientFill "+(e.gradient.type?' type="'+e.gradient.type+'" ':"")+(e.gradient.left?' left="'+e.gradient.left+'" ':"")+(e.gradient.right?' right="'+e.gradient.right+'"':"")+(e.gradient.top?' top="'+e.gradient.top+'" ':"")+(e.gradient.bottom?' bottom="'+e.gradient.bottom+'" ':"")+(e.gradient.degree?' degree="'+e.gradient.degree+'" ':"")+" >";for(var l=0;l<e.gradient.stops.length;l++)t+='<stop position="'+e.gradient.stops[l].position+'">',t+='<color rgb="'+e.gradient.stops[l].color+'" /></stop>';t+="</gradientFill>"}return t+"</fill>"},r=function(e){if(e.fill&&e.fill.pattern){var t={};return t.pattern=e.fill.pattern,t.fgColor=e.fill.foreColor||!1,t.bgColor=e.fill.backColor||e.fill.color||!1,t}if(e.fill&&e.fill.gradient&&e.fill.gradient.stops){var t={};t.gradient={},t.gradient.degree=e.fill.gradient.degree||!1,t.gradient.bottom=e.fill.gradient.bottom||!1,t.gradient.left=e.fill.gradient.left||!1,t.gradient.right=e.fill.gradient.right||!1,t.gradient.top=e.fill.gradient.top||!1,t.gradient.type=e.fill.gradient.type||!1,t.gradient.stops=[];for(var n=0;n<e.fill.gradient.stops.length;n++){var r={};r.position=e.fill.gradient.stops[n].position||0,r.color=e.fill.gradient.stops[n].color||!1,t.gradient.stops.push(r)}return t}return!1},l=function(t,n){return n._fills[e.stringify(t)]},o=function(t,n){n._fills||(n._fills={},n._fillsCount=0);var r=n._fillsCount++;return n._fills[e.stringify(t)]=""+r,n._fills[e.stringify(t)]},s=function(e,t){for(var n,r=0,l=0,o=0;o<t.length;o++)for(var s=t[0];r<e.styles.length;r++)if((void 0!==e.styles[r].cellIndices[s]||null!==e.styles[r].cellIndices[s])&&(n=e.styles[r],l++,Object.keys(n.cellIndices).length!==t.length||l>1||0===n._fill))return!1;return!!n&&n._fill},i=function(t,n,r){return a(t,n,r,!0),r._fills[e.stringify(t)]=n,n},a=function(t,n,r,l){var o;for(var s in r._fills)if(r._fills[s]===n){o=JSON.parse(s);break}l&&delete r._fills[e.stringify(o)];for(var s in t)t[s]&&(o[s]=t[s]),t[s]=o[s];return t},u=function(e,t){var n,a=!1,u=r(t),f=e._fills?l(u,e):null;return void 0!==f&&null!==f?n=f:a=!0,n||!1!==(f=s(e,t.cellIndices))&&(n=i(u,f,e)),void 0!==n&&null!==n||(n=o(u,e)),{fill:u,fillIndex:n,newStyleCreated:a}},f=function(e,t){var n,r=0;for(n=0;n<t.styles.length;n++)if(t.styles[n]._fill===e&&(r+=Object.keys(t.styles[n].cellIndices).length)>1)return r;return r};return{generateContent:t,getFillForCell:function(e,t,n){var s,u=!1,d=r(t),c=e._fills?l(d,e):null;if(void 0!==c&&null!==c?s=c:u=!0,n&&n._fill){f(n._fill,e)<=1&&(s=i(d,n._fill,e))}return void 0!==s&&null!==s||(n&&n._fill&&(d=a(d,n._fill,e,!1)),s=o(d,e)),!s&&n&&n._fill&&(s=n._fill),{fill:d,fillIndex:s,newStyleCreated:u}},getFillForCells:u}}),n("oxml_xlsx_styles",["utils","oxml_xlsx_font","oxml_xlsx_num_format","oxml_xlsx_border","oxml_xlsx_fill"],function(e,t,n,r,l){var o=function(e){var o='<?xml version="1.0" encoding="utf-8" standalone="yes"?><styleSheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main">',s=0;for(o+=n.generateContent(e),o+=t.generateContent(e),o+=l.generateContent(e),o+=r.generateContent(e),o+='<cellStyleXfs count="1"><xf /></cellStyleXfs>',o+='<cellXfs count="'+(parseInt(e.styles.length,10)+1)+'"><xf />',s=0;s<e.styles.length;s++){var i=e.styles[s]._numFormat?' numFmtId="'+e.styles[s]._numFormat+'" ':"",a=e.styles[s]._border?' borderId="'+e.styles[s]._border+'" ':"",u=e.styles[s]._fill?' fillId="'+e.styles[s]._fill+'" ':"";o+='<xf fontId="'+e.styles[s]._font+'" '+i+a+u+" />"}return o+="</cellXfs></styleSheet>"},s=function(e,t){var n=o(t);e.addFile(n,t.fileName,"workbook")},i=function(e,t,n){var r=e.getLastSheet(),l=parseInt((r.Id||"rId0").replace("rId",""),10)+1;return n.addContentType("Override","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",{PartName:"/workbook/style"+l+".xml"}),t.addRelation("rId"+l,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles","style"+l+".xml"),l},a=function(e,t){for(var n=0;n<e.styles.length;n++)if(void 0!==e.styles[n].cellIndices[t]&&null!==e.styles[n].cellIndices[t])return e.styles[n];return null},u=function(e,t){for(var n=0;n<e.styles.length;n++)if(e.styles[n]._font===t._font&&e.styles[n]._numFormat===t._numFormat)return e.styles[n];return null},f=function(e,o){if(e.cellIndex||e.cellIndices){var s,i,f,d,c,m=!1;if(e.cellIndex){if(s=a(o,e.cellIndex),i=t.getFontForCell(o,e,s),f=n.getNumFormatForCell(o,e,s),d=r.getBorderForCell(o,e,s),c=l.getFillForCell(o,e,s),m=m||i.newStyleCreated||d.newStyleCreated||c.newStyleCreated,s){if(s._font===i.fontIndex&&s._numFormat===f.numFormatIndex&&s._border===d.borderIndex&&s._fill===c.fillIndex)return s;if(1===Object.keys(s.cellIndices).length)return s._font=i.fontIndex,s._numFormat=f.numFormatIndex,s._border=d.borderIndex,s._fill=c.fillIndex,s;delete s.cellIndices[e.cellIndex]}return!m&&(s=u(o,{_font:i.fontIndex,_numFormat:f.numFormatIndex,_border:d.borderIndex,_fill:c.fillIndex}))?(s.cellIndices[e.cellIndex]=Object.keys(s.cellIndices).length,s):(s={_font:i.fontIndex,_numFormat:f.numFormatIndex||!1,_border:d.borderIndex,_fill:c.fillIndex,cellIndices:{}},s.cellIndices[e.cellIndex]=0,s.index=""+(parseInt(o.styles.length,10)+1),o.styles.push(s),s)}if(e.cellIndices){var v;if(i=t.getFontForCells(o,e),f=n.getNumFormatForCells(o,e),d=r.getBorderForCells(o,e),c=l.getFillForCells(o,e),!(m=m||i.newStyleCreated||f.newStyleCreated||d.newStyleCreated||c.newStyleCreated)&&(s=u(o,{_font:i.fontIndex,_numFormat:f.numFormatIndex,_border:d.borderIndex,_fill:c.fillIndex}))){for(v=0;v<e.cellIndices.length;v++){var g=e.cellIndices[v],y=a(o,g);delete y.cellIndices[g],s.cellIndices[g]=Object.keys(s.cellIndices).length}return s}for(s={_font:i.fontIndex,_numFormat:f.numFormatIndex,_border:d.borderIndex,_fill:c.fillIndex,cellIndices:{}},v=0;v<e.cellIndices.length;v++){var g=e.cellIndices[v],y=a(o,g);if(y&&delete y.cellIndices[g],s.cellIndices[g]=Object.keys(s.cellIndices).length,y&&!Object.keys(y.cellIndices).length){for(key in s)y[key]=s[key];return y}}return s.index=""+(parseInt(o.styles.length,10)+1),o.styles.push(s),s}}};return{createStyle:function(t,n,r){var l=i(t,n,r),a={sheetId:l,fileName:"style"+l+".xml",styles:[],_fonts:{},_borders:{},_fills:{},_fontsCount:1,_bordersCount:1,_fillsCount:2},u={bold:!1,italic:!1,underline:!1,size:!1,color:!1,strike:!1,family:!1,name:!1,scheme:!1};a._fonts[e.stringify(u)]=0,a._borders[!1]=0,a._fills[!1]=0;var d={pattern:"gray125",fgColor:!1,bgColor:!1};return a._fills[e.stringify(d)]=1,{_styles:a,generateContent:function(){return o(a)},attach:function(e){s(e,a)},addStyles:function(e){return f(e,a)}}}}}),n("oxml_workbook",["oxml_content_types","oxml_rels","oxml_sheet","oxml_xlsx_styles"],function(e,t,n,r){"use strict";var l=function(e){return e._rels.relations.length?e._rels.relations[e._rels.relations.length-1]:{}},o=function(e,t){var n,r='<workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"><sheets>';for(n=0;n<e.sheets.length;n++)r+='<sheet name="'+e.sheets[n]._sheet.sheetName+'" sheetId="'+e.sheets[n]._sheet.sheetId+'" r:id="'+e.sheets[n]._sheet.rId+'" />',t&&e.sheets[n].attach(t);return r+="</sheets></workbook>"},s=function(e){if(e._sharedStrings&&Object.keys(e._sharedStrings).length){var t='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><sst xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main">';for(var n in e._sharedStrings)t+="<si><t>"+n+"</t></si>";return t+="</sst>"}return""},i=function(e,t){var r=l(e),o=parseInt((r.Id||"rId0").replace("rId",""),10)+1;t=t||"sheet"+o,e._rels.addRelation("rId"+o,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","sheets/sheet"+o+".xml");var s=n.createSheet(t,o,"rId"+o,e);return e.sheets.push(s),e.xlsxContentTypes.addContentType("Override","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",{PartName:"/workbook/sheets/sheet"+o+".xml"}),s},a=function(e,t){t._rels.attach(e);var n=o(t,e);e.addFile(n,"workbook.xml","workbook");var r=s(t);r&&e.addFile(r,"sharedstrings.xml","workbook"),t._styles&&t._styles.attach(e)},u=function(e,t){if(e){if(!t._sharedStrings){t._sharedStrings={},t.xlsxContentTypes.addContentType("Override","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",{PartName:"/workbook/sharedstrings.xml"});var n=l(t),r=parseInt((n.Id||"rId0").replace("rId",""),10)+1;t._rels.addRelation("rId"+r,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings","sharedstrings.xml")}return isNaN(t._sharedStrings[e])&&(t._sharedStrings[e]=Object.keys(t._sharedStrings).length||0),t._sharedStrings[e]}},f=function(e,t){return t._sharedStrings[e]},d=function(e){var t;for(delete e.xlsxContentTypes,delete e.xlsxRels,e._rels.destroy(),e._rels.destroy=null,delete e._rels.destroy,e._rels=null,delete e._rels,e.generateContent=null,delete e.generateContent,e.attach=null,delete e.attach,e.addSheet=null,delete e.addSheet,e.createSharedString=null,delete e.createSharedString,e.getSharedString=null,delete e.getSharedString,e._sharedStrings=null,delete e._sharedStrings,t=0;t<e.sheets.length;t++)e.sheets[t].destroy(),e.sheets[t].destroy=null,delete e.sheets[t].destroy,e.sheets[t]=null;e.sheets=null,delete e.sheets};return{createWorkbook:function(e,n){var s={sheets:[],xlsxContentTypes:e,xlsxRels:n};return s._rels=t.createRelation("workbook.xml.rels","workbook/_rels"),s.addSheet=function(e){return i(s,e)},s.generateContent=function(){return o(s)},s.attach=function(e){a(e,s)},s.createSharedString=function(e){return u(e,s)},s.getSharedString=function(e){return f(e,s)},s.destroy=function(){d(s)},s.createStyles=function(){return s._styles||(s._styles=r.createStyle(s,s._rels,e)),s._styles},s.getLastSheet=function(){return l(s)},s}}}),n("oxml_xlsx",["fileHandler","oxml_content_types","oxml_rels","oxml_workbook"],function(e,t,n,r){"use strict";var l={},o=function(t,n,r){try{var l=e.createFile();return r.contentTypes.attach(l),r._rels.attach(l),r.workBook.attach(l),l.saveFile(t,n)}catch(e){if(n)n("Err: Not able to create Workbook.");else if("undefined"!=typeof Promise)return new Promise(function(e,t){t("Err: Not able to create Workbook.")})}},s=function(){var e={};e.contentTypes=t.createContentType(),e.contentTypes.addContentType("Default","application/vnd.openxmlformats-package.relationships+xml",{Extension:"rels"}),e.contentTypes.addContentType("Default","application/xml",{Extension:"xml"}),e.contentTypes.addContentType("Override","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",{PartName:"/workbook/workbook.xml"}),e._rels=n.createRelation(".rels","_rels"),e._rels.addRelation("rId1","http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument","workbook/workbook.xml"),e.workBook=r.createWorkbook(e.contentTypes,e._rels);var l=function(t,n){if("undefined"==typeof JSZip)if(n)n("Err: JSZip reference not found.");else if("undefined"!=typeof Promise)return new Promise(function(e,t){t("Err: JSZip reference not found.")});return o(t,n,e)},s=function(){e.workBook.destroy(),delete e.workBook,e._rels.destroy(),delete e._rels,
e.contentTypes.destroy(),delete e.contentTypes,e=null};return{_xlsx:e,sheet:e.workBook.addSheet,download:l,destroy:s}};return l.xlsx=s,window.oxml||(window.oxml=l),l}),t("oxml_xlsx")}()}(this);